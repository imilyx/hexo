---
title: '【学习笔记】带权二分'
date: 2021-02-03 12:56:05
tags: 
    - 学习笔记
    - 带权二分
mathjax: true
---

这玩意儿其实早几个月就学了，现在来补笔记。

带权二分又称 wqs 二分，解决的是这样一类问题：有 $n$ 个物品，需要在强制选 $K$ 个物品的前提下最大/最小化代价；设强制选 $K$ 个的代价最值为 $val(K)$，$val(K)$ 无法直接求得，但是 $val$ 函数的最值以及取到最值的位置可以求，并且 **$val$ 是一个凸函数**。

现在讨论求上凸函数最大值（下凸函数最小值一个道理）。令 $f(x) = val(x) + kx$，$k$ 的实际意义是「多选一个物品就要付出的代价」，在坐标系上就是将 $val$ 的导函数向上平移了 $k$。导函数与 $x$ 轴的交点对应的就是 $val$ 的最高点，且上凸函数的导函数递减，因此 **$k$ 变大，最值点右移**，可二分。最后让 $val(K) = f(K) - kx$。

求下凸函数最小值，**$k$ 变大，最值点左移**

**调边界是真的恶心**，自闭了

习题：[林克卡特树](https://loj.ac/p/2478) [题解](https://imilyx.github.io/2021/02/02/%E4%B9%9D%E7%9C%81%E8%81%94%E8%80%832018%20%E4%B9%B1%E5%86%99/#%E6%9E%97%E5%85%8B%E5%8D%A1%E7%89%B9%E6%A0%91)