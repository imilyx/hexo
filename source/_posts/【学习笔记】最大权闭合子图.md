---
title: '【学习笔记】最大权闭合子图'
date: 2020-12-26 09:47:40
tags:
    - 网络流
mathjax: true
---

## 最大权闭合子图
---

看到一篇很好的博客，终于会了这玩意儿！qwq 咱不来虚的哈，直接上正题

* 什么是最大权闭合子图：

    每个点有点权，点权和最大的闭合子图即为最大权闭合子图

* 如何求解

    先说结论：$S$ 向正权点连，边权为权值，$T$ 向负权点连，边权为权值绝对值。**最大权闭合子图权值即为正权和 - 最大流。**

    证明（半感性）：**$S -> T$ 的流量就是损失。** 尽量选正权点为起点，所以 $S$ 向正权点连。一个正权点选会导致后续选一些负权点，但我们不知道选当前正权点是否优，就先选上，顶多后面被负权点损失掉为 $0$，不会亏。

习题：

### [$Salty\ Fish$](https://vjudge.net/problem/HDU-6634)

显然的最大权闭合子图模型。本质却是贪心——一个摄像头尽可能的清理掉子树里剩下的苹果中，深度大的。

与深度有关就长链剖分，开一个 $map$，$mp[x, d]$ 维护 $x$ 子树中深度为 $d$ 的苹果个数。每个苹果只在所在长链的根处被合并一次，$O((n + m)logn)$

然而这题要直接继承重儿子的 $map$，不然就 $MLE$。。以后写代码也注意一点。

[$Code$](http://acm.hdu.edu.cn/viewcode.php?rid=34972168)