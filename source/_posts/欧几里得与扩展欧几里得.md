---
title: 欧几里得与扩展欧几里得
date: 2018-02-03 18:18:49
tags:
    - 扩展欧几里得
mathjax: true
---

## Gcd
---------------


欧几里得算法又称辗转相除法，用于计算两个整数的最大公约数.

引理：
    求整数a、b的最大公约数，表示成 gcd(a,b)，设r = a % b，则 gcd(a,b) = gcd(b,a % b).

证明:
    a = kb + r, r = a % b.
    假设c是a、b的公约数，则 c|a,c|b,r = a - kb，因此c|r.
    因此c也是(b,a % b)的公约数.
    c|b,c|r,a = kb + r.
    所以c也是(a,b)的公约数.
    既然(a,b）与(b,a % b)的公约数相等，其最大公约数也必然相等，得证.
    (gcd(a,0)=a)

CODE:
``` c++
int gcd(int a,int b) {
	return b ? gcd(b,a % b) : a;
}
```



## exGcd
---------

扩展欧几里得算法，简称exGcd，一般用来求解不定方程、线性同余方程、模的逆元等.

引理：存在x、y使得 ax + by = gcd(a,b).

证明：
    当b=0时，gcd(a,b)=a,此时x = 1, y = 0, x、y必然存在.
    当b!=0时，
    设 ax0 + by0 = gcd(a,b) = gcd(b,a % b) = bx1 + (a % b)y1.
    又因为 a % b = a - a / b × b
    则 ax0 + by0 = bx1 + (a - a / b × b）y1
       ax0 + by0 = bx1 + ay1 - ab / b × y1
       ax0 + by0 = ay1 + bx1 - ba / b × y1
       ax0 + by0 = ay1 + b(x1 - a / b × y1)
    解得 x0 = y1, y0 = (x1 - ay1 / b)
    因为每一组的解可根据后一组得到， 所以x、y必然存在.
    得证.

实现：
    因为每次解都要根据后一组得到，所以使用递归做法，相当于从b = 0，x = 1，y = 0一层层翻上来，不断算出当前层的解并返回.

CODE:
``` c++
void exGcd(int a,int b) {
	if(b==0) {
		x = 1,y = 0; return;
	}
	exGcd(b,a % b);
	t = x;
	x = y;
	y = t - a / b * y;
	return;
}
```



## exGcd求解不定方程
--------------------

    对 ax + by = c 的不定方程， 我们将它转换成ax + by = gcd(a,b）的
exGcd形式.
    设d = gcd(a,b).
    当c % d != 0时无整数解.
    当c % d = 0时，将方程右边乘上d/c，转换为ax + by = d.
    根据扩展欧几里得算法求得一组整数解x0,y0，但因为是转换过的方程解，所以还应该要乘上c/d变回去，则原方程解x1 = x0c / r, y1 = y0c / r.
    通解x = x1 + b / d * t, y = y1 - a / d * t.
    b/d、a/d为最小的系数，因为它们互质.