---
title: 'NOI2020网络同步赛体验记'
date: 2020-08-18 18:49:40
tags:
    - 比赛
---

## Day1
---

勤勤恳恳的扣了 114 分，取模错误 wa + 字母打错，fst 成 82 分。。。好难受啊

整整 32 分啊。这如果是联赛，谁担的起呢。

## Day2
---

勤勤恳恳的扣了 ？分（对我自己都不确定正确性），民间数据还没出（出了也不测 qvq）

## 出成绩了
-----

108

-----

【此处应有题解】

-----

来补了。

## $D1T1. 美食家$

我想到矩阵快速幂了！写出 5n 个点的转移柿子了！甚至想到预处理 $2^i$ 的矩阵、行向量去乘是 $n^2$ 的了！

但我没写出来。。。好吧，不会就是不会，复杂度是 $O((5n)^3\ log\ T + (5n)^2\ log\ T \times K)$。你别看他有 4e8，人家是 O(能过) 耶= =

upd：考场代码分段乘的时候额外贡献加错位置了= = 我哭

``` c++
#include <bits/stdc++.h>
#define rep(i, x, y) for (int i = x; i <= y; i++)
using namespace std;

typedef long long ll;
const int N = 55, M = 255;
int n, m, T, K;
int c[N];
struct mat {
    ll x[M][M], n, m;
} f, g[32];
struct festi {
    int t, x, y;
} fes[M];

int ord(int x, int y) { return (x - 1) * 5 + y; }

bool cmp_fes(festi a, festi b) { return a.t < b.t; }

mat operator * (mat a, mat b) {
    mat c;
    memset(c.x, ~0x3f, sizeof(c.x));
    c.n = a.n, c.m = b.m;
    rep(i, 1, a.n)
        rep(j, 1, b.m)
            rep(k, 1, a.m)
                c.x[i][j] = max(c.x[i][j], a.x[i][k] + b.x[k][j]);
    return c;
}

int main() {
    cin >> n >> m >> T >> K;
    rep(i, 1, n) scanf("%d", &c[i]);

    memset(f.x, ~0x3f, sizeof(f.x));
    memset(g[0].x, ~0x3f, sizeof(g[0].x));
    f.x[1][1] = c[1];
    f.n = 1, f.m = g[0].n = g[0].m = 5 * n;
    rep(i, 1, n)
        rep(j, 1, 4)
            g[0].x[ord(i, j)][ord(i, j + 1)] = 0;

    rep(i, 1, m) {
        int x, y, z; scanf("%d%d%d", &x, &y, &z);
        g[0].x[ord(x, z)][ord(y, 1)] = c[y];
    }
    rep(i, 1, 30) g[i] = g[i - 1] * g[i - 1];

    rep(i, 1, K)
        scanf("%d%d%d", &fes[i].t, &fes[i].x, &fes[i].y);
    sort(fes + 1, fes + K + 1, cmp_fes);
    fes[0].t = 0;
    fes[K + 1].t = T;
    rep(i, 1, K + 1) {
        int tim = fes[i].t - fes[i - 1].t;
        rep(j, 0, 30) if ((tim >> j) & 1) f = f * g[j];
        if (i <= K) {
            f.x[1][ord(fes[i].x, 1)] += fes[i].y;
        }
    }
    printf("%lld\n", max(-1ll, f.x[1][1]));
    return 0;
}
```