---
title: 'UR 17 题解'
date: 2021-03-28 16:48:40
tags: 
    - 比赛
mathjax: true
---

[传送门](https://uoj.ac/contest/43)

### $T1$

题目看错了！是前缀 and！

显然最终一定是链，挂在链的最下方肯定比挂在之前的某个节点下优。

$f_S = \min( f_{S \& a_i} + (S \& a_i) )$

然而每次减少正整数个位，而且一个 $a_i$ 不会被 $\&$ 两次，想到枚举子集，预处理哪些子集可以被减掉。虽然也很爆炸但总比 $O(nA)$ 好。

要剪枝！就nm滑稽！

[$Code$](https://uoj.ac/submission/465235)

### $T2$

二分。怎么判定？

幸好这是直的，所以一个人的轨迹固定，另一个人就是单调的。设 $(x, y)$ 表示一个人在点 $x$，另一个在点 $y$ 的状态，$(x1, y1)$ 和 $(x2, y2)$ 可达当且仅当两人的距离都 $\leq lim$。$f_{x, y}$ 表示状态 $x$ 是否合法，从 $(stx, sty)$ 开始跑 bfs 就行了？

但是有可能一个人为了配合另一个人而同时移动诶！GG

冷静思考。准确来说应该是如果两个状态中两人所在的边都相同。~~你不会让 $f_{x, y}$ 表示一个人在边 $x$，另一个在边 $y$ 吧？很难转移的。~~

$f_{x, y}$ 表示一个人在点 $x$，另一个在边 $y$ 上距离点 $x$ 最近的位置。讨论是谁在配合谁，转移分两种：

1. 第一个人从 $x$ 走到相邻边，为了配合第二个人走到 $y$ 的某个端点。
2. 第二个人仍旧在 $y$ 上走，为了配合第一个人从 $x$ 走到相邻点。

[$Code$](https://uoj.ac/submission/465324)

### $T3$

完全不会啦……

$$ans = \int_0^2 Pr[\lambda = x]x dx = 2 - \int_0^2 Pr[\lambda \leq x] dx$$

考虑如何求 $Pr[\lambda \leq x]$。设 $g(s, x, t)$ 表示点集 $s$ 点权最大值 $\leq x$，$\max(点权最大值，边权最大值) \leq t$ 的概率。

- 若点权都 $\leq \frac{t}{2}$ 则概率就是 $(\frac{t}{2})^{|s|}$
- 否则最大点权 $> \frac{t}{2}$，考虑扣掉最大点权的点和与它直接相连的点集，不会和剩下的点矛盾。（为什么？）

$$g(s, x, t) = (\frac{t}{2})^{|s|} + \sum\limits_{i \in s} \int_{\frac{t}{2}}^x g(s', y, t) (t - y)^{|s| - |s'| - 1} dy$$

$s'$ 表示从 $s$ 中扣掉「最大点权的点和与它直接相连的点集」后的集合。

$g(s, x, t)$ 其实是个关于 $x$ 和 $t$ 的二元生成函数。那怎么求啊？？

我们发现每一项 $x^i t^j$ 都满足 $i + j = |s|$（积分后项数加一），那么把 $x$ 当作主变量就好啦（就是把 $t^k$ 看作 $x^{n - k}$）。

上面那个柿子，$\int$ 有下界，怎么办？$t$ 被视为常数啦，所以 $y \leq \frac{t}{2}$ 的贡献就从常数项里减掉。

最终答案里 $x$ 只要不超过 $t$ 即可，因此：

$$ans = 2 - \int_0^2 g(all, min(1, t), t) dt = 2 - \int_0^1 g(all, t, t) dt - \int_1^2 g(all, 1, t) dt$$

这时把 $t$ 当成主变量，那么把形式幂级数 reverse 一下就可以了~

~~xml 弱弱问道：怎么算微积分……~~

~~$\mathscr{Naive}$！求导 + 积分啊~~

实现细节：不同连通块分别做然后乘起来，可以大大减小状态数。

[~~跑的贼啦快的~~代码](https://uoj.ac/problem/372)