---
title: '近期数数特训'
date: 2021-09-04 20:58:59
tags: 
mathjax: true
---

打算开一些专题，~~都是卡的 [这位大佬](https://blog.csdn.net/qq_35950004/) 题单~~ 当然是从愉悦的数数开始啦 ~

# $\text{GF}$、组合数学

# 容斥

## [$\text{CF997C}$](https://www.luogu.com.cn/problem/CF997C)

旧题重做~~实际上已经全忘光了~~

与其说这叫转化，倒不如说从容斥的式子里抽掉了第一项再取个反。哎本质相同啦（（我就是想说题目写的很容斥T T

求每行或每列颜色全部不同的方案数

$$
= 3 \sum\limits_{i \geq 1, j \geq 1} (-1)^{i + j} \binom{n}{i} \binom{n}{j} 3^{(n - i)(n - j)} + 2 \sum\limits_{i \geq 1} (-1)^i \binom{n}{i} 3^{n(n - i)} 3^i  + 3^{n^2}\\
= 3 \sum\limits_{i \geq 1} (-1)^i \binom{n}{i} [ (3^{n - i} - 1)^n - 3^{n(n - i)} ] + 2 \sum\limits_{i \geq 1} (-1)^i \binom{n}{i} 3^{n(n - i)} 3^i  + 3^{n^2}
$$

[$Code$](https://codeforces.com/problemset/submission/997/127876988)

## [$\text{AGC035F}$](https://www.luogu.com.cn/problem/AT5143)

$a[i, j] = [ k_i \geq j ] + [ l_j \geq i ]$，所以说我们只关心「能否跨过交点」？

本质不同计数的套路是，每种本质相同的方案集合里选一个特征方案，然后进行特征方案的计数。

我们称满足 $l_i = j, k_j = i - 1$ 或 $l_i = j - 1, k_j = i$ 的 $(i, j)$ 为 $\text{qwq pair}$

给出结论：两个方案本质相同当且仅当存在至少一对 $\text{qwq pair}$，满足一个方案中 $l_i = j, k_j = i - 1$，另一个方案中 $l_i = j - 1, k_j = i$

- 充分性：显然
- 必要性：设第一个方案为 $k, l,$ 第二个方案为 $k', l'$

  反证，假设不存在两个方案中长得不同的 $\text{qwq pair}$

  找到最小的 $j$，使得 $l_j \neq l'_j$，不妨设 $l_j < l'_j$

  那么至少需要满足 $k_{l'_j} \geq j, k'_{l'_j} < j$

  若 $j > 1$：若 $k'_{l'_j} < j - 1$，则 $(l'_j, j - 1)$ 在两个方案不同，因此 $k'_{l'_j} = j - 1$，矛盾；

  若 $j = 1$：$(l'_j, j)$ 就是 $\text{qwq pair}$ ~ 矛盾！

  必要性得证。
  
选某本质相同方案集合里的特征方案为，所有 $\text{qwq pair}$ 中 $l_i$ 都等于 $j$ 的方案。

即容斥出不存在 $l_i = j - 1、k_j = i$ 的方案数。

$$
ans = \sum\limits_{i = 0}^{min(n, m)} (-1)^i \binom{n}{i} \binom{m}{i} i! (m + 1)^{n - i} (n + 1)^{m - i}
$$

## [$\text{LOJ6181-}$某个套路求和题](https://loj.ac/p/6181)

看到 $\mu$，容易想到 $f$ 在平方因子处为 $0$，质数处为 $-1$，其余为 $1$（这个用二项式定理即可解释）。

$$
f(n) = \mu^2(n) - 2 \text{[n is prime]}
$$

前面这个的前缀和有经典套路（本质是容斥）：

$$
\sum\limits_{i = 1}^n \mu^2(i) = \sum\limits_{i = 1}^{\sqrt{n}} \mu(i) \lfloor \frac{n}{i^2} \rfloor
$$

后面这部分可以 min25，等价于求 $G(n)$, $k = 0$

## [二分图染色](https://loj.ac/p/6160)

~~第一反应是拟阵我是不是没救了~~

图什么的显然不太可扩展。

二分图一个常用 trick 是移到网格图上，而且这题又是完全二分图，十分符合。

把绿色视为无色，不需要考虑它 qwq

问题转为每行每列不存在 $> 1$ 个红点或蓝点。

首先不能重复染一个位置，但两种颜色的限制又是独立的。我们想分别考虑。

设 $f(n)$ 表示在 $n \times n$ 的棋盘内放置一种颜色的棋子的方案数

$$
ans = \sum\limits_{i = 0}^n (-1)^i \binom{n}{i}^2 i! f^2(n - i)
$$

考虑 $f$ 如何计算。

考虑从 $n - 1$ 阶方阵推到 $n$ 阶方阵

我们可以在第 $n$ 行选一个位置 $(n, k)$ $(k \leq n - 1)$ 染色，然后将之前 $n - 1$ 阶方阵第 $k$ ~ $n - 1$ 列平移至 $k + 1$ ~ $n$ 列，当然也可以染 $(k, n)$，也可以选择不染，也可以选择染 $(n, n)$，总共是 $2n$ 种方案。

算重的情况是，染 $(n, k_1)$，$(k_2, n - 1)$ 有色；染 $(k_2, n)$，$(n - 1, k_1)$ 有色。

总之就是第 $n$ 行和第 $n$ 列有两个位置冲突了。

考虑把我们染色的那个格子朝对应的方向推进去一格，然后数这样的 $n - 1$ 阶方阵，个数为 $f(n - 2)$，而选位置有 $(n - 1)^2$ 种选择，

$$
f(n) = 2n f(n - 1) - (n - 1)^2 f(n - 2)
$$

[$Code$](https://loj.ac/s/1246093)