---
title: 'PE 做题记录'
date: 2021-08-10 17:28:40
tags:
mathjax: true
---

事情的起因是 cly_none 学长的 PE 杂题选讲。PE txdy！

PE 题解区链接：https://projecteuler.net/thread=[+题号]

## [$PE713$](https://projecteuler.net/problem=713)

等价于询问最少加多少条边，补图中不存在大小为 $m$ 的团。

补图不存在大小为 $m$ 的团 $\Longleftrightarrow$ 原图不存在大小为 $m$ 的独立集

证明比较 naive，原图一个独立集 $I$ 两两无直接连边，所以在补图中它们两两有直接连边，构成团。原图的独立集和补图的团构成映射。

原图边最少，补图边最多

### *turan's theorem*

$$
T(n, r) 表示边数最多的图边数，使得 n 个点的图不存在大小为 r + 1 的点团。所以答案就是 \binom{n}{2} - T(n, m - 1)
$$

### *turan graph*

#### 性质一：$G$ 是完全多部图。完全多部图的定义是，能划分为多个集合，同集合中点无直接连边，不同集合中点一定连边

反证，如果不是完全多部图，一定存在一个三元组对 $(u, v, w)$ 满足 $uv$ 有连边、$uw$ 无连边且 $vw$ 无连边。

设当前不存在 $r + 1$ 团。
1. $d(w) \leq d(u), d(v)$
将 $w$ 变为 $u$ 或 $v$ 的拷贝，边数增大，且依然不存在 $r + 1$ 团。
2. $d(w) > d(u), d(v)$
将 $u$ 和 $v$ 变为 $w$ 的拷贝，边数增大，且依然不存在 $r + 1$ 团。
*「$uv$ 有连边、$uw$ 无连边且 $vw$ 无连边」的 $(u, v, w)$ 是不优的*。

#### 性质二：完全 $k$ 部图每个部分大小至多相差 $1$

考虑完全 $k$ 部图的最大边数，$\frac{n}{k} (n - \frac{n}{k}) * k / 2 = (1 - \frac{1}{k}) \frac{n^2}{2}$

$k$ 越大边越多。因此 $G$ 为完全 $r$ 部图时最优。完全 $r + 1$ 部图需要存在大小为 $r + 1$ 的团，就不行了呗。

完全多部图的补图…… 好像没什么特殊性质。

稍微特殊的是 $r = 2$ 时，根据 turan's theorem 最大边数为 $\frac{n^2}{4}$，即要消掉一半左右的边才能获得无三角图。

## [$PE635$](https://projecteuler.net/problem=635)

### 做法一

二元生成函数（恰好 $p$ 个）+ 单位根反演，是很自然的想法。

$x$ 上指数表示和，$y$ 上指数表示选取个数。

$F_i(x, y) = (1 + x^i y)$

设 $f(x, y) = \prod\limits_{i = 0}^{p - 1} F_i(x, y)$

$$
ans = [y^p] \sum\limits_{i \geq 0} [x^{ip}] f(x, y) \\
= \frac{1}{p} [y^p] \sum\limits_{i = 0}^{p - 1} f(\omega_p^i, y) \\
= \frac{1}{p} [y^p] \sum\limits_{i = 0}^{p - 1} \prod\limits_{j = 1}^{3p} (1 + \omega_p^{ij} y)
$$

你发现对于每个 $i > 0$，后面这坨 $\prod\limits_{j = 1}^{3p} (1 + \omega_p^{ij} y)$ 相等！

$$
ans = \frac{1}{p} [y^p] [ (1 + y)^{3p} + (p - 1) ( \prod\limits_{i = 0}^{p - 1} (1 + \omega_p^{i} y)^3 ) ]
$$

将 $0$ 和 $p$ 个单位根（$-\omega_p^{-i}$）带入 $y$，都满足 $\prod\limits_{i = 0}^{p - 1} (1 + \omega_p^i y) = y^p + 1$，那么等式两边的两个 $p$ 次多项式相等。

$$
ans = \frac{1}{p} [y^p] [ (1 + y)^{3p} + (p - 1) (y^p + 1)^3 ] \\
= \frac{1}{p}[ \binom{3p}{p} + 3(p - 1) ]
$$
 
### 做法二

排一个 $3 * p$ 的矩阵，任选 $p$ 个，若存在一行不为空且不为满就循环位移那行，只存在一种方案使得总和是 $p$ 倍数。一行黑两行白的方案特殊处理。$ans = \frac{\binom{3p}{p} - 3}{p} + 3$

## [$PE755$](https://projecteuler.net/problem=755)

根据 zeckendorf 定理，每个数和 01 串构成映射关系！

我们称数值上相同的 01 串在同个等价类中。

考虑算一个 zeckendorf 01 串的等价类大小。一个 $1$ 往后移，可以看作 $0$ 序列减 $2$，会导致消掉开头若干个 $0$ 的长度。$dp[i, 0/1]$ 表示到第 $i$ 个 0，有无减 $2$ 标记。

考虑加入数位 dp 算所有 zeckendorf 01 串，$dp[p, len, 0/1, 0/1]$ 表示到第 $p$ 个，距离上个 $1$ 有 $len$ 距离，上界是否满，是否有减 $2$ 标记

* （无关，常用式）斐波那契的组合意义：$f_0 + f_1 + \cdots + f_n = f_{n + 2} - 1$

~~数位 dp 太麻烦了，写了个 $1e7$ 以内背包，其余暴搜的算法水过去了（？）~~

## [$PE503$](https://projecteuler.net/problem=503)

Alice 的决策是：设第 $i$ 轮结果为 $j$，存在阀值排名 $rk_i$ 使得 $j < rk_i$ 时停止，$j \geq rk_i$ 时继续前进，是最优方案。

设 $f_i$ 表示 $[i, n]$ 按照定下的阀值策略走，最终的期望大小。

不会严谨证明啊 QwQ…… ~~毛估估还是一脸正确的~~ 问题在于如何求出 $f$？

考虑倒推，$f_n$ 显然是平均数 $\frac{n + 1}{2}$。对于 $i < n$，枚举第 $i$ 局的可能阀值 $k$，选出最小的「$< k$ 时的期望大小（$e$） + $\geq k$ 时的期望大小（$p * f_{i + 1}$）」。

直接做是 $n^2$ 的，但是你发现 $rk_i \leq rk_{i + 1}$，加这个优化就跑得飞快。

细节：计算 $e$ 时，需要知道「$[1, n]$ 选 $m$ 个数，第 $k$ 大数的期望大小」，考虑在 $n$ 个球之间插 $m$ 块板子，每块板子前的球数就是这个数的大小，$1$ 前不能插，$n$ 后可以插。不如加一个球，这样实际将 $n + 1$ 个球随机分成 $m + 1$ 块，每块期望大小都是 $\frac{n + 1}{m + 1}$，第 $k$ 大就是 $\frac{n + 1}{m + 1} k$

## [$PE659$](https://projecteuler.net/problem=659)

$n$ 非常迷惑，不如消掉它。一顿消可以得出 $p \mid 4k^2 + 1$, 二次剩余求 $\sqrt{-1}$，$2k \equiv \frac{u}{2}, \frac{v}{2} \pmod{p}$，每个 $k$ 初始维护 $4k^2 + 1$, 枚举 $p$ 到 $\sqrt{4k^2 + 1}$ 范围，把所有满足条件的 $k$ 上维护的数字除 $p$，若某个 $k$ 最后剩下不为 $1$ 那剩下的那个就是这个 $k$ 的最大质因子。