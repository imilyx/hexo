---
title: '【学习笔记】LGV 引理'
date: 2021-03-03 20:04:40
tags:
    - 学习笔记
mathjax: true
---

---

LGV 引理，用来处理**有向无环图**上的不相交路径计数问题。

- $w(Path)$ 表示 $Path$ 这条路径上的边权积，也可以是生成函数，这样就能搞很多事情
- $e(u, v)$ 表示 $u$ 到 $v$ 所有路径的 $w(Path)$ 之和
- $N(\sigma)$ 表示 $\sigma$ 这个排列的逆序对数
- 有矩阵 $M$ 和点集 $A$、$B$，$M_{i, j} = e(A_i, B_j)$

$$ans = det(M) = \sum\limits_{S : A \rightarrow B} (-1)^{N(\sigma(S))} \prod\limits_{i = 1}^n w(S_i)$$

其中 $S$ 这个映射是在枚举 $A$ 到 $B$ 的每个路径组。

感性理解挺容易的，所有相交的路径从排列角度都可以看作在相交的那一刻互换灵魂，会形成逆序对；只要逆序对数 $> 0$，经过类行列式的容斥，这个路径组贡献就是 $0$。

---

### [$Gym102978-A$](https://codeforces.com/gym/102978/problem/A)

先不考虑 $a_{R, C} = V$。划一条折线 $i$ 表示分割了 $val_i$ 和 $val_{i + 1}$，共有 $k - 1$ 条线，将每条线向右向下平移一个单位后转化成不相交路径计数，上 LGV。

考虑 $a_{R, C} = V$。诶——也就是说恰好 $V - 1$ 条折线跨过了 $(R, C)$ 西北方向的直线！怎么用 LGV 呢？边积 + 生成函数！把 $(R, C)$ 西北方向的所有路径的 $w()$ 赋为 $z$，答案就是行列式求出的生成函数第 $V - 1$ 项。然而行列式套卷积什么的显然boom，考虑见过的套路——随便什么带进去，最后插回来得到系数。

[$Code$](https://vjudge.net/solution/29880391)

---

~~好诶 又水了一篇~~ 碰到有趣的题目会回来写的啦