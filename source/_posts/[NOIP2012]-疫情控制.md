---
title: '[NOIP2012]-疫情控制'
date: 2018-07-10 22:56:40
tags: 
    - 最近公共祖先
mathjax: true
---

http://codevs.cn/problem/1218/

题意：不好说。。自己看。。

本题答案满足单调性——若 ans 个小时内能控制疫情，则对于任意 $k \geq ans$ ，k 个小时内当然也能控制疫情。所以我们二分 mid。

军队可以分为两类，一是 mid 小时内无法到达根节点的军队，对于他们，就让他们尽量往根节点走，因为越靠近根节点，管辖的叶子节点越多。

二是 mid 小时内能够到达根节点的军队，我们让这些军队移动到根节点的儿子节点上，用三元组 (i, s, rest) 表示，其中 i 代表军队编号，s 表示军队来自根节点的哪一个子节点，rest 表示军队 i 到达 s 之后还剩余多少时间。这些军队有两种使用方法：仍然驻扎在 s ，或者跨过根节点去管辖其他的子树。

由贪心的决策包容性可以证明，若存在一支军队 (i, s, rest) 满足叶子节点 s 未被管辖且军队 i 在 rest 时间内无法从 s 移动到根节点再返回 s，则在最优解中，s 一定被自己子树内部的一支军队驻扎，不可能由其他子树的军队跨过根结点过来驻扎。

现在，仍未确定驻扎地点的军队都可以使用第二类方法——跨过根结点去管辖其他子树。我们把未被管辖的子树按到根的距离从小到大排序，剩余军队按“rest 减去 s 到根的距离”从小到大排序，执行一个贪心扫描算法。最后判断能否全部管辖，就知道二分的值是否可行了。

整个算法 $O((n + m)\ log\ n\ log\ SUM)$ ，其中 SUM 表示所有边的长度之和。