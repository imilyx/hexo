---
title: 数学期望（马尔可夫链）
date: 2018-05-31 22:41:40
tags:
    - 数学
mathjax: true
---

这篇博客主要介绍马尔可夫链，当然涉及到数学期望。
先来看看马尔可夫链百度百科上的背景：
```
由安德烈·马尔可夫发现，是指数学中具有马尔可夫性质的离散事件随机过程，可以从一个状态变到另一个状态，也可以保持当前状态。状态的改变叫做转移，与不同的状态改变相关的概率叫做转移概率。随机漫步就是马尔可夫链的例子。随机漫步中每一步的状态是在图形中的点，每一步可以移动到任何一个相邻的点，在这里移动到每一个点的概率都是相同的（无论之前漫步路径是如何的）。
```

先来看一道例题：有一条长度为 C 的路径，你处于 0 的位置，每次可以往右走一步（在 0 处时只能往右走）或往左走一步，求期望？
期望 = 概率 乘以 步数。

我们用 $E(x)$ 表示从 x 走到 n 的期望步数。$E(x)$ 需要理解成“就从 x 开始走，前面不用管它”。
我们发现，$E(x)$ 有两种方法走到，一种是从 x - 1 向右走一步，一种是从 x + 1 向左走一步，联系期望的定义与概念，我们可以推出：

$$E(x) = \frac{E(x - 1) + E(x + 1)}{2} + 1$$

怎么求值？首先要明确，这并不是DP。会出现 $E(x)$ 和 $E(x + 1)$ 中出现彼此的情况，但这不是DP，所以也不叫后效性。这就好比解一个一元一次方程，3x + 4 = 5x + 6，并不妨碍解题。

我们可以用高斯消元来做，当然也可以代入。请注意这是解方程。

当然了，最终马尔可夫链的公式是：

$$E(u) = \sum_{u,v \in E}{P(u,v)[E(v) + w(u, v)]}$$

其中 P(u,v) 表示概率，w(u,v) 表示 u 到 v 的贡献。

大致就是这些，理解也很不透彻，但期望这东西以后应该会经常碰到，具体事例具体分析吧。