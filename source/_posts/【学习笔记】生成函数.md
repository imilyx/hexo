---
title: 'ã€å­¦ä¹ ç¬”è®°ã€‘ç”Ÿæˆå‡½æ•°'
date: 2020-12-06 23:14:05
tags: 
    - ç”Ÿæˆå‡½æ•°
mathjax: true
---

è¿æ°”å¥½çš„è¯ä¹Ÿè®¸ä¸ç”¨é‡ä¿®ï¼Ÿæ„Ÿè§‰æŒºå¥½ç†è§£å‘€ï¼

## ~~æ— è¶£çš„~~$åŸºæœ¬æ¦‚å¿µå’ŒæŠ€æœ¯$
---

* çº¦å®šï¼š$f'(x)$ è¡¨ç¤ºå¯¹ $f(x)$ æ±‚å¯¼

ç”Ÿæˆå‡½æ•°çš„ç³»æ•°ä»Žå…·ä½“çš„æ•°è¢«æŽ¨å¹¿åˆ°äº†**å½¢å¼å¹‚çº§æ•°**ã€‚

å¤§å°å‡½æ•°ï¼šå¥½éš¾è¯´æ¸…æ¥šï¼Ÿå°±æ˜¯æ¯”å¦‚æŸä¸ªç”Ÿæˆå‡½æ•°ç¬¬ $n$ é¡¹çš„å¤§å°å‡½æ•° $= n$ã€‚ä¸åŒçš„æƒ…å¢ƒä¸‹å¤§å°å‡½æ•°è¢«èµ‹äºˆä¸åŒçš„å®žé™…æ„ä¹‰ã€‚

æ™®é€šç”Ÿæˆå‡½æ•°ï¼šOGF

* æ— æ ‡å·xxè®¡æ•°

æŒ‡æ•°ç”Ÿæˆå‡½æ•°ï¼šEGF

* æœ‰æ ‡å·xxè®¡æ•°ï¼Œæ˜¯æ³°å‹’çº§æ•°çš„å½¢å¼ã€‚åˆå¹¶çš„æ—¶å€™ä¼š $C(n + m, n)$ é‡æ–°åˆ†é…æ ‡å·ï¼š$[x^n]f(x) = a_n\frac{x^n}{n!}$, $[x^m]g(x) = b_m\frac{x^m}{m!}$, åˆå¹¶èµ·æ¥å°±å¯¹ $[x^{n + m}]$ æœ‰è´¡çŒ®ï¼š$a_nb_m\frac{x^{n + m}}{n!m!}$ã€‚

æ³°å‹’çº§æ•°ï¼š

* $e^x = \sum\limits_{k \geq 0} \frac{x^k}{k!}$

* [æ³°å‹’å±•å¼€](https://baike.baidu.com/item/%E6%B3%B0%E5%8B%92%E5%85%AC%E5%BC%8F/7681487?fr=aladdin)

æ±‚å¯¼ï¼š$x^n = nx^{n - 1}$ï¼Œä¸Žç”Ÿæˆå‡½æ•°çš„å·¦ç§»ä½ç›¸å¯¹åº”ã€‚

æ±‚ç§¯åˆ†ï¼š$\int x^n dx = \frac{1}{n + 1} x^{n + 1}$ï¼Œä¸Žç”Ÿæˆå‡½æ•°çš„å³ç§»ä½ç›¸å¯¹åº”ã€‚

ä¹˜æ³•é€†å…ƒï¼š

* $A(x)B(x) \equiv 1 \pmod {x^n}$

* $A(x)$ æœ‰ä¹˜æ³•é€†å…ƒçš„å……è¦æ¡ä»¶æ˜¯ $A(x)$ çš„å¸¸æ•°é¡¹æœ‰ä¹˜æ³•é€†å…ƒã€‚å¿…è¦æ€§ï¼š$[x^0] A(x) [x^0] B(x) = 1$

* æœ‰[æ±‚æ³•](https://www.luogu.com.cn/paste/2x7n21r1),ï¼ˆæ³¨ï¼šè¿™é‡Œçš„ $B'$ ä¸æ˜¯æ±‚å¯¼ï¼Œå°±æ˜¯å•çº¯è¡¨ç¤ºå¦ä¸€ä¸ªç”Ÿæˆå‡½æ•°ï¼‰æ¯æ¬¡ç®—å‡º $2B' - AB'^2$ èµ‹ç»™ $B$ï¼Œæ¯æ¬¡è§„æ¨¡å‡å°ä¸€åŠï¼Œ$T(n) = T(n/2)+O(nlogn) = O(nlogn)$ï¼ˆæ˜¯ä¸æ˜¯å¾ˆåƒç‰›é¡¿è¿­ä»£ï¼Ÿï¼‰

å¤åˆé€†ï¼šè‹¥å¯¹äºŽä¿©å‡½æ•° $f(x)$ å’Œ $g(x)$ è€Œè¨€æœ‰ $g(f(x)) = x$ï¼Œåˆ™å¯ä»¥çœ‹ä½œ $x$ åœ¨ $g \cdot f$ çš„ä½œç”¨ä¸‹ä¿æŒä¸å˜ï¼Œç§° $g$ ä¸º $f$ çš„å¤åˆé€†ã€‚**å¯¹ $f$ å’Œ $g$ æœ‰è¦æ±‚ï¼šå¸¸æ•°é¡¹ä¸º 0 ä¸”ä¸€æ¬¡é¡¹ç³»æ•°ä¸ä¸º 0**ã€‚

* æœ‰ç»“è®ºï¼šè‹¥ $g(f(x)) = x$ åˆ™ $f(g(x)) = x$ï¼Œ$f$ ä¸Ž $g$ äº’ä¸ºå¤åˆé€†ã€‚

* æœ‰æ±‚å¯¼æ–¹å¼ï¼š$f(g(x))' = f'(g(x))g'(x)$

* æœ‰æ±‚æ³•ï¼šðŸ‘‡

æ±‚æ³•å°±æ˜¯æ‹‰æ ¼æœ—æ—¥åæ¼”ï¼š

* å·²çŸ¥ $f(x)$ æ±‚ $g(x)$ï¼Œ$[x^n] g(x) = \frac{1}{n} [w^{n - 1}] (\frac{w}{f(w)})^n$

* æŽ¨å¹¿å½¢å¼ï¼š$[x^n]h(g(x)) = \frac{1}{n} [w^{n - 1}] h'(w) (\frac{w}{f(w)})^n$

å¯¹æ•°å‡½æ•°ï¼š$ln$

* $ln(A(x)) = \sum\limits_{i \geq 1} \frac{A(x)^i}{i}$

* æœ‰ç»“è®ºï¼š$ln'(x) = \frac{1}{x}$

* æœ‰æ±‚æ³•ï¼š$ln(A(x)) = \int (ln A(x))' = \int \frac{A'(x)}{A(x)}$ï¼Œæ‰€ä»¥å¯¹ $A(x)$ æ±‚å¯¼ä½œä¸º $a$ï¼Œæ±‚é€†ä½œä¸º $b$ï¼Œ$a * b$ å†ç§¯åˆ†å°±å¾—åˆ°äº† $ln$ã€‚

æŒ‡æ•°å‡½æ•°ï¼š$exp$

* $exp(A(x)) = \sum\limits_{i \geq 0} \frac{A(x)^i}{i!}$

* æœ‰æ±‚æ³•ï¼šðŸ‘‡

æ±‚æ³•å°±æ˜¯ç‰›é¡¿è¿­ä»£ï¼š

* è®¾ $f(x) = e^{A(x)}$, åˆ™å¾—åˆ°æ–¹ç¨‹ $g(f(x)) = ln(f(x)) - A(x) = 0$. è®¾å·²æ±‚å¾— $f$ å‰ $n$ é¡¹ $f_0(x)$ï¼Œå³ $f(x) \equiv f_0(x) \pmod {x^n}$. å¯¹ $g(f(x))$ ä½œæ³°å‹’å±•å¼€ï¼Œæ•´ç†å¯å¾— $f(x) \equiv f_0(x) - \frac{g(f_0(x))}{g'(f_0(x))} \pmod {x^{2n}}$, å¸¦å…¥ $g(f(x))$ å®šä¹‰å¯å¾— $f(x) = f_0(x)(1 - ln(f_0(x)) + A(x))$ï¼ŒæŒ‰æ­¤è¿­ä»£ï¼Œ$T(n) = T(n/2)+O(nlogn) = O(nlogn)$

å¯¹æ•°å‡½æ•°å’ŒæŒ‡æ•°å‡½æ•°çš„æ€§è´¨åœ¨è¿™é‡Œä»ç„¶æˆç«‹ã€‚

å¤šé¡¹å¼å¿«é€Ÿå¹‚ï¼šæ±‚ $A(x)^k$

* ç›´æŽ¥å¿«é€Ÿå¹‚æ˜¯ $O(n\ logn\ logk)$ çš„
* æœ‰ $O(nlogn)$ æ±‚æ³•ï¼š$A(x)^k = exp(k\ ln\ A(x))$

## $æœ‰è¶£çš„è¡¨ç¤ºï¼$
---

æœ‰æ ‡å·ç®€å•æ— å‘å›¾çš„ EGFï¼š$G(x) = \sum\limits_{n \geq 0} 2^{\binom{n}{2}} \frac{x^n}{n!}$

æœ‰æ ‡å·æ— å‘è¿žé€šå›¾çš„ EGFï¼š$C(x) = ln(G(x))$

æ— æ ‡å·çŽ¯çš„ OGFï¼š$-\sum\limits_{d \geq 1} \frac{\phi(d)}{d} ln(1 - A(x^d))$, $ln(1 - A(x^d))$ ä¸­åªæœ‰ $n/d$ é¡¹æ˜¯æœ‰ç”¨çš„

## $æœ‰è¶£çš„é¢˜ç›®ï¼$
---

### [$åŸŽå¸‚è§„åˆ’$](https://www.luogu.com.cn/problem/P4841)

$G(x) = e^{C(x)} = \sum\limits_{n \geq 0} 2^{\binom{n}{2}} \frac{x^n}{n!}$ï¼Œç›´æŽ¥æ±‚ $ln(G(x))$ å³å¯

### [$The\ Child\ and\ Binary\ Tree$](https://www.luogu.com.cn/problem/CF438E)

### [$ZJOI2019-å¼€å…³$](https://www.luogu.com.cn/problem/P5326)

[é“¾æŽ¥]()

### [$LOJ6538-çƒ·åŸºè®¡æ•°$](https://loj.ac/p/6538)

æ…•åè€Œæ¥ï¼

å“¦ï¼Œæ‰€ä»¥æ— æ ‡å·è®¡æ•°ä¸€èˆ¬ä¼šç”¨åˆ°ç¾¤è®ºé‚£å¥—ç†è®ºæ˜¯å—ï¼Ÿå¦ˆå¦ˆæˆ‘ $burnside$ å­¦å€¼äº†ï¼

$F(x) = 1 + xF(x)^3$ æ˜¾ç„¶ä¸è¡Œã€‚è€ƒè™‘ $burnside$ï¼Œä¸€ä¸ªç‚¹åªæœ‰ä¸‰ä¸ªå„¿å­å…± $3! = 6$ ç§ç½®æ¢ï¼š

- $(1, 2, 3): F(x)^3$
- $(1, 3, 2)(3, 2, 1)(2, 1, 3): 3F(x)F(x^2)$
- $(2, 3, 1)(3, 1, 2): 2F(x^3)$

æ‰€ä»¥ $F(x) = 1 + \frac{x}{6}(F(x)^3 + 3F(x)F(x^2) + 2F(x^3))$

åˆ†æ²» NTT $O(nlog^2n)$, ç‰›é¡¿è¿­ä»£ $O(nlogn)$

æˆ‘åªä¼šåˆ†æ²» NTTã€‚ã€‚å·å•Šå·å·å•Šå· å°±å¯ä»¥äº†ã€‚å…·ä½“æ¥è¯´å·çš„æ–¹æ³•åˆ†åˆ«å¦‚ä¸‹ï¼š

* $F(x)^3$: $[l, mid]$ ä¸‰æ¬¡
* $3F(x)F(x^2)$: $[l, mid]$ ä¸€æ¬¡ï¼Œ$[mid + 1, r]$ ä¸€æ¬¡
* $2F(x^3)$: $l \neq 0$ çš„æ—¶å€™ $2l > r$ï¼Œæ‰€ä»¥ $[l, mid]$ ä¸€æ¬¡ï¼Œ$[0, r - l]$ ä¸¤æ¬¡ï¼›$l = 0$ çš„æ—¶å€™ $[l, mid]$ ä¸‰æ¬¡ã€‚

[$Code$](https://loj.ac/s/1012212)