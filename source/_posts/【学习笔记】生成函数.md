---
title: 'ã€å­¦ä¹ ç¬”è®°ã€‘ç”Ÿæˆå‡½æ•°'
date: 2020-12-06 23:14:05
tags: 
    - ç”Ÿæˆå‡½æ•°
mathjax: true
---

è¿æ°”å¥½çš„è¯ä¹Ÿè®¸ä¸ç”¨é‡ä¿®ï¼Ÿæ„Ÿè§‰æŒºå¥½ç†è§£å‘€ï¼

## ~~æ— è¶£çš„~~$åŸºæœ¬æ¦‚å¿µå’ŒæŠ€æœ¯$
---

* çº¦å®šï¼š$f'(x)$ è¡¨ç¤ºå¯¹ $f(x)$ æ±‚å¯¼

ç”Ÿæˆå‡½æ•°çš„ç³»æ•°ä»å…·ä½“çš„æ•°è¢«æ¨å¹¿åˆ°äº†**å½¢å¼å¹‚çº§æ•°**ã€‚

å¤§å°å‡½æ•°ï¼šå¥½éš¾è¯´æ¸…æ¥šï¼Ÿå°±æ˜¯æ¯”å¦‚æŸä¸ªç”Ÿæˆå‡½æ•°ç¬¬ $n$ é¡¹çš„å¤§å°å‡½æ•° $= n$ã€‚ä¸åŒçš„æƒ…å¢ƒä¸‹å¤§å°å‡½æ•°è¢«èµ‹äºˆä¸åŒçš„å®é™…æ„ä¹‰ã€‚

æ™®é€šç”Ÿæˆå‡½æ•°ï¼šOGF

* æ— æ ‡å·xxè®¡æ•°

æŒ‡æ•°ç”Ÿæˆå‡½æ•°ï¼šEGF

* æœ‰æ ‡å·xxè®¡æ•°ï¼Œæ˜¯æ³°å‹’çº§æ•°çš„å½¢å¼ã€‚åˆå¹¶çš„æ—¶å€™ä¼š $C(n + m, n)$ é‡æ–°åˆ†é…æ ‡å·ï¼š$[x^n]f(x) = a_n\frac{x^n}{n!}$, $[x^m]g(x) = b_m\frac{x^m}{m!}$, åˆå¹¶èµ·æ¥å°±å¯¹ $[x^{n + m}]$ æœ‰è´¡çŒ®ï¼š$a_nb_m\frac{x^{n + m}}{n!m!}$ã€‚

æ³°å‹’çº§æ•°ï¼š

* $e^x = \sum\limits_{k \geq 0} \frac{x^k}{k!}$

* [æ³°å‹’å±•å¼€](https://baike.baidu.com/item/%E6%B3%B0%E5%8B%92%E5%85%AC%E5%BC%8F/7681487?fr=aladdin)

æ±‚å¯¼ï¼š$x^n = nx^{n - 1}$ï¼Œä¸ç”Ÿæˆå‡½æ•°çš„å·¦ç§»ä½ç›¸å¯¹åº”ã€‚

æ±‚ç§¯åˆ†ï¼š$\int x^n dx = \frac{1}{n + 1} x^{n + 1}$ï¼Œä¸ç”Ÿæˆå‡½æ•°çš„å³ç§»ä½ç›¸å¯¹åº”ã€‚

ä¹˜æ³•é€†å…ƒï¼š

* $A(x)B(x) \equiv 1 \pmod {x^n}$

* $A(x)$ æœ‰ä¹˜æ³•é€†å…ƒçš„å……è¦æ¡ä»¶æ˜¯ $A(x)$ çš„å¸¸æ•°é¡¹æœ‰ä¹˜æ³•é€†å…ƒã€‚å¿…è¦æ€§ï¼š$[x^0] A(x) [x^0] B(x) = 1$

* æœ‰[æ±‚æ³•](https://www.luogu.com.cn/paste/2x7n21r1),ï¼ˆæ³¨ï¼šè¿™é‡Œçš„ $B'$ ä¸æ˜¯æ±‚å¯¼ï¼Œå°±æ˜¯å•çº¯è¡¨ç¤ºå¦ä¸€ä¸ªç”Ÿæˆå‡½æ•°ï¼‰æ¯æ¬¡ç®—å‡º $2B' - AB'^2$ èµ‹ç»™ $B$ï¼Œæ¯æ¬¡è§„æ¨¡å‡å°ä¸€åŠï¼Œ$T(n) = T(n/2)+O(nlogn) = O(nlogn)$ï¼ˆæ˜¯ä¸æ˜¯å¾ˆåƒç‰›é¡¿è¿­ä»£ï¼Ÿï¼‰

å¤åˆé€†ï¼šè‹¥å¯¹äºä¿©å‡½æ•° $f(x)$ å’Œ $g(x)$ è€Œè¨€æœ‰ $g(f(x)) = x$ï¼Œåˆ™å¯ä»¥çœ‹ä½œ $x$ åœ¨ $g \cdot f$ çš„ä½œç”¨ä¸‹ä¿æŒä¸å˜ï¼Œç§° $g$ ä¸º $f$ çš„å¤åˆé€†ã€‚**å¯¹ $f$ å’Œ $g$ æœ‰è¦æ±‚ï¼šå¸¸æ•°é¡¹ä¸º 0 ä¸”ä¸€æ¬¡é¡¹ç³»æ•°ä¸ä¸º 0**ã€‚

* æœ‰ç»“è®ºï¼šè‹¥ $g(f(x)) = x$ åˆ™ $f(g(x)) = x$ï¼Œ$f$ ä¸ $g$ äº’ä¸ºå¤åˆé€†ã€‚

* æœ‰æ±‚å¯¼æ–¹å¼ï¼š$f(g(x))' = f'(g(x))g'(x)$

* æœ‰æ±‚æ³•ï¼šğŸ‘‡

æ±‚æ³•å°±æ˜¯æ‹‰æ ¼æœ—æ—¥åæ¼”ï¼š

* å·²çŸ¥ $f(x)$ æ±‚ $g(x)$ï¼Œ$[x^n] g(x) = \frac{1}{n} [w^{n - 1}] (\frac{w}{f(w)})^n$

* æ¨å¹¿å½¢å¼ï¼š$[x^n]h(g(x)) = \frac{1}{n} [w^{n - 1}] h'(w) (\frac{w}{f(w)})^n$

å¯¹æ•°å‡½æ•°ï¼š$ln$

* $ln(A(x)) = \sum\limits_{i \geq 1} \frac{A(x)^i}{i}$

* æœ‰ç»“è®ºï¼š$ln'(x) = \frac{1}{x}$

* æœ‰æ±‚æ³•ï¼š$ln(A(x)) = \int (ln A(x))' = \int \frac{A'(x)}{A(x)}$ï¼Œæ‰€ä»¥å¯¹ $A(x)$ æ±‚å¯¼ä½œä¸º $a$ï¼Œæ±‚é€†ä½œä¸º $b$ï¼Œ$a * b$ å†ç§¯åˆ†å°±å¾—åˆ°äº† $ln$ã€‚

æŒ‡æ•°å‡½æ•°ï¼š$exp$

* $exp(A(x)) = \sum\limits_{i \geq 0} \frac{A(x)^i}{i!}$

* æœ‰æ±‚æ³•ï¼šğŸ‘‡

æ±‚æ³•å°±æ˜¯ç‰›é¡¿è¿­ä»£ï¼š

* è®¾ $f(x) = e^{A(x)}$, åˆ™å¾—åˆ°æ–¹ç¨‹ $g(f(x)) = ln(f(x)) - A(x) = 0$. è®¾å·²æ±‚å¾— $f$ å‰ $n$ é¡¹ $f_0(x)$ï¼Œå³ $f(x) \equiv f_0(x) \pmod {x^n}$. å¯¹ $g(f(x))$ ä½œæ³°å‹’å±•å¼€ï¼Œæ•´ç†å¯å¾— $f(x) \equiv f_0(x) - \frac{g(f_0(x))}{g'(f_0(x))} \pmod {x^{2n}}$, å¸¦å…¥ $g(f(x))$ å®šä¹‰å¯å¾— $f(x) = f_0(x)(1 - ln(f_0(x)) + A(x))$ï¼ŒæŒ‰æ­¤è¿­ä»£ï¼Œ$T(n) = T(n/2)+O(nlogn) = O(nlogn)$

å¯¹æ•°å‡½æ•°å’ŒæŒ‡æ•°å‡½æ•°çš„æ€§è´¨åœ¨è¿™é‡Œä»ç„¶æˆç«‹ã€‚

å¤šé¡¹å¼å¿«é€Ÿå¹‚ï¼šæ±‚ $A(x)^k$

* ç›´æ¥å¿«é€Ÿå¹‚æ˜¯ $O(n\ logn\ logk)$ çš„
* æœ‰ $O(nlogn)$ æ±‚æ³•ï¼š$A(x)^k = exp(k\ ln\ A(x))$

## $æœ‰è¶£çš„è¡¨ç¤ºï¼$
---

æœ‰æ ‡å·ç®€å•æ— å‘å›¾çš„ EGFï¼š$G(x) = \sum\limits_{n \geq 0} 2^{\binom{n}{2}} \frac{x^n}{n!}$

æœ‰æ ‡å·æ— å‘è¿é€šå›¾çš„ EGFï¼š$C(x) = ln(G(x))$

æ— æ ‡å·ç¯çš„ OGFï¼š$-\sum\limits_{d \geq 1} \frac{\phi(d)}{d} ln(1 - A(x^d))$, $ln(1 - A(x^d))$ ä¸­åªæœ‰ $n/d$ é¡¹æ˜¯æœ‰ç”¨çš„

## $æœ‰è¶£çš„é¢˜ç›®ï¼$
---

### [$åŸå¸‚è§„åˆ’$](https://www.luogu.com.cn/problem/P4841)

$G(x) = e^{C(x)} = \sum\limits_{n \geq 0} 2^{\binom{n}{2}} \frac{x^n}{n!}$ï¼Œç›´æ¥æ±‚ $ln(G(x))$ å³å¯

### [$The\ Child\ and\ Binary\ Tree$](https://www.luogu.com.cn/problem/CF438E)

### [$ZJOI2019-å¼€å…³$](https://www.luogu.com.cn/problem/P5326)

å•å†™åšå®¢äº†

### [$LOJ6538-çƒ·åŸºè®¡æ•°$](https://loj.ac/p/6538)

æ…•åè€Œæ¥ï¼

å“¦ï¼Œæ‰€ä»¥æ— æ ‡å·è®¡æ•°ä¸€èˆ¬ä¼šç”¨åˆ°ç¾¤è®ºé‚£å¥—ç†è®ºæ˜¯å—ï¼Ÿå¦ˆå¦ˆæˆ‘ $burnside$ å­¦å€¼äº†ï¼

è®¾çƒ·åŸºç”Ÿæˆå‡½æ•°ä¸º $A(x)$ã€‚$A(x) = 1 + xA(x)^3$ æ˜¾ç„¶ä¸è¡Œã€‚è€ƒè™‘ $burnside$ï¼Œä¸€ä¸ªç‚¹åªæœ‰ä¸‰ä¸ªå„¿å­å…± $3! = 6$ ç§ç½®æ¢ï¼š

- $(1, 2, 3): A(x)^3$
- $(1, 3, 2)(3, 2, 1)(2, 1, 3): 3A(x)A(x^2)$
- $(2, 3, 1)(3, 1, 2): 2A(x^3)$

æ‰€ä»¥ $A(x) = 1 + \frac{x}{6}(A(x)^3 + 3A(x)A(x^2) + 2A(x^3))$

åˆ†æ²» NTT $O(nlog^2n)$, ç‰›é¡¿è¿­ä»£ $O(nlogn)$

æˆ‘åªä¼šåˆ†æ²» NTTã€‚ã€‚å·å•Šå·å·å•Šå· å°±å¯ä»¥äº†ã€‚å…·ä½“æ¥è¯´å·çš„æ–¹æ³•åˆ†åˆ«å¦‚ä¸‹ï¼š

* $A(x)^3$: $[l, mid]$ ä¸‰æ¬¡
* $3A(x)A(x^2)$: $[l, mid]$ ä¸€æ¬¡ï¼Œ$[mid + 1, r]$ ä¸€æ¬¡
* $2A(x^3)$: $l \neq 0$ çš„æ—¶å€™ $2l > r$ï¼Œæ‰€ä»¥ $[l, mid]$ ä¸€æ¬¡ï¼Œ$[0, r - l]$ ä¸¤æ¬¡ï¼›$l = 0$ çš„æ—¶å€™ $[l, mid]$ ä¸‰æ¬¡ã€‚

[$Code$](https://loj.ac/s/1012212)

### [$LOJ6512-çƒ·çƒƒè®¡æ•°$](https://loj.ac/p/6512)

ä¸ä¸Šä¸€é¢˜çš„åŒºåˆ«ä¹Ÿæ˜¯æ­¤é¢˜çš„éš¾ç‚¹ï¼Œæ˜¯**æ— æ ¹æ ‘**ã€‚ä¸éš¾æƒ³åˆ°æ ‘çš„é‡å¿ƒï¼Œç”šè‡³ $4$ ä¸ªå„¿å­çš„ $burnside$ å¼•ç†ä½ éƒ½æƒ³å¥½äº†ä½†è¿˜æ˜¯ä¸çŸ¥é“æ€ä¹ˆåˆ‡å…¥ã€‚

è®¾çƒ·çƒƒç”Ÿæˆå‡½æ•°ä¸º $B(x)$ã€‚

> æœ‰ç»“è®ºï¼š$c - d + e = 1$
> 
> $c$ ä¸ºç‚¹ç­‰ä»·ç±»ä¸ªæ•°ã€‚ä¸¤ä¸ªç‚¹åœ¨ä¸€ä¸ªç­‰ä»·ç±»ä¸­ï¼Œå½“ä¸”ä»…å½“åˆ†åˆ«ä»¥ä¸¤ä¸ªç‚¹ä¸ºæ ¹çš„æœ‰æ ¹æ ‘åŒæ„ã€‚
> 
> $d$ ä¸ºè¾¹ç­‰ä»·ç±»ä¸ªæ•°ã€‚ä¸¤æ¡è¾¹åœ¨ä¸€ä¸ªç­‰ä»·ç±»ä¸­ï¼Œå½“ä¸”ä»…å½“åˆ†åˆ«åˆ å»ä¸¤æ¡è¾¹å¾—åˆ°çš„æœ‰æ ¹æ ‘åŒæ„ã€‚
> 
> $e$ ä¸ºæ˜¯å¦å­˜åœ¨ä¸€æ¡è¾¹ä½¿å¾—æ–­æ‰åä¸¤è¾¹ä»¥æ–­è¾¹ç«¯ç‚¹ä¸ºæ ¹çš„å­æ ‘åŒæ„ã€‚
> 
> è¯æ˜ï¼š
> 
> 1. $e = 0$ï¼Œæ ¹ä¸ºé‡å¿ƒï¼Œè‡ªæˆä¸€ä¸ªç­‰ä»·ç±»ï¼›å¯¹äºå‰©ä¸‹çš„ç‚¹ï¼Œå®ƒä»¬çš„çˆ¶è¾¹åœ¨åŒä¸€ä¸ªè¾¹ç­‰ä»·ç±»ä¸­ï¼Œå½“ä¸”ä»…å½“å®ƒä»¬åœ¨åŒä¸€ä¸ªç‚¹ç­‰ä»·ç±»ä¸­ï¼Œ$c - d = 1$.
> 2. $e = 1$ï¼Œåœ¨è¿æ¥ä¸¤ä¸ªé‡å¿ƒçš„è¾¹ä¸ŠåŠ å…¥ä¸€ä¸ªç‚¹å˜æˆæœ‰æ ¹æ ‘ï¼Œè½¬ä¸ºæƒ…å†µ 1.

æ¨åˆ°ç”Ÿæˆå‡½æ•°å½¢å¼ï¼Œ$C(x) - D(x) + E(x) = B(x)$

$C(x)$ å¯ä»¥çœ‹ä½œæ‰€æœ‰ä¸åŒæ„çš„æ— æ ‡å·æ— æ ¹æ ‘çš„ $c$ ä¹‹å’Œï¼Œå³æ‰€æœ‰ä¸åŒæ„çš„æ— æ ‡å·æœ‰æ ¹æ ‘ä¸ªæ•°ï¼Œ$C(x) = \frac{x}{24} ( A(x)^4 + 6A(x)^2A(x^2) + 3A^2(x^2) + 8A(x)A(x^3) + 6A(x^4) )$

$D(x)$ å¯ä»¥çœ‹ä½œåœ¨è¾¹ä¸ŠåŠ ä¸€ä¸ªç‚¹èƒ½æ„æˆå¤šå°‘ä¸ªä¸åŒçš„æœ‰æ ¹æ ‘ï¼Œ$D(x) = \frac{(A(x) - 1)^2 + (A(x^2) - 1)}{2}$

$E(x)$ å¯ä»¥çœ‹ä½œåŒæ„æœ‰æ ¹æ ‘ä¸ªæ•°ï¼Œ$E(x) = A(x^2)$

[$Code$](https://loj.ac/s/1012789)

### [$çç $](https://loj.ac/p/3120)

æ¦‚ç‡ç”Ÿæˆå‡½æ•°ç›¸å…³ã€‚

ã€ç™½äº‘ç™½å…”å¯çˆ±ï¼å–œæ¬¢é¢˜é¢ã€‘.jpg

å·§å¦™ç”Ÿæˆå‡½æ•°ï¼$\sum\limits_{i = 1}^D \lfloor \frac{cnt_i}{2} \rfloor \geq m \Rightarrow \sum\limits_{i = 1}^D cnt_i \% 2 \leq n - 2m$ï¼Œç‰¹åˆ¤ä¸åˆæ³•æƒ…å†µã€‚

æšä¸¾ $cnt_i \% 2 = 1$ å³å¥‡æ•°çš„ä¸ªæ•°ï¼Œè®¾ $odd_i$ è¡¨ç¤ºæœ‰ $i$ ä¸ªå¥‡æ•°çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™ $ans = \sum\limits_{i = 1}^{n - 2m}$

$odd$ æ˜¯æ°å¥½ï¼Œä¸å¥½ç®—ï¼ŒäºŒé¡¹å¼åæ¼”ä¸€æ³¢ï¼šè®¾ $f$ è¡¨ç¤ºè‡³å°‘, æ¥ä¸‹æ¥å°±ç®— $f$

$$odd_i = \sum\limits_{j = i}^D (-1)^{j - i} C(j, i) f_j$$

$$= \sum\limits_j (-1)^{j - i} \frac{j!}{i!(j - i)!} f_j$$

$$= \frac{1}{i!} \sum_j \frac{(-1)^{j - i}}{(j - i)!} j!f_j$$

æ˜¾ç„¶çš„å·ç§¯å½¢å¼ã€‚

ä¼šæƒ³èµ·æ•°åˆ— ${0, 1, 0, 1, \cdots}$ çš„ $EGF$ ä¸º $\frac{e^x - e^{-x}}{2}$ï¼Œæœ‰ï¼š

$$f_k = C(D, k) n! [x^n] ( (\frac{e^x - e^{-x}}{2})^k (e^x)^{D - k} )$$

$$= C(D, k) \frac{n!}{2^k}\sum\limits_{j = 0}^k C(k, j) (-1)^{k - j} e^{(D + 2(j - k))x}$$

$$= \frac{C(D, k)}{2^k} \sum\limits_{j = 0}^k \frac{k!}{j!(k - j)!} (-1)^j (D - 2j)^n$$

$$= \frac{D!}{2^k(D - k)!} \sum\limits_{j = 0}^k \frac{(-1)^j (D - 2j)^n}{j!} \frac{1}{(k - j)!}$$

å·ç§¯ï¼å®Œäº‹äº†ã€‚