---
title: '21Feb å­¦ä¹ è®¡åˆ’'
date: 2021-02-28 23:59:59
tags: 
mathjax: true
---

## $\mathcal{2.1}$
---

### [$ICPC\ WF\ 2019-äº¤é€šå µå¡$](https://loj.ac/p/6587)

ä»¤ $p_i = r_i + g_i$, $P = lcm(p_i)$ï¼Œæ˜¾ç„¶ $P\ |\ 2019!$ã€‚æ‰€ä»¥åœ¨ $[0, 2019!]$ ä¸­éšæœºå®æ•° = åœ¨ $[0, 2019!)$ ä¸­éšæœºå®æ•° = åœ¨ $[0, P)$ ä¸­éšæœºæ•´æ•°ã€‚

å°†æŸä¸ªå‡ºå‘æ—¶é—´ $t$ è¡¨ç¤ºä¸º $kX + a$ çš„å½¢å¼ï¼Œå…¶ä¸­ $X$ æ˜¯æˆ‘ä»¬é’¦å®šçš„å¸¸æ•°ï¼Œ$a \in [0, X)$ã€‚ç°åœ¨æˆ‘ä»¬è¦è§£åŒä½™æ–¹ç¨‹ç»„ $kX + a + x_i \geq r_i\ mod\ p_i$ï¼Œå¯¹äºä¸åŒçš„ $a$ åˆ†åˆ«å¤„ç†ï¼ˆè¿™é‡Œæ¦‚ç‡æ˜¾ç„¶æ˜¯å¯åŠ çš„ï¼‰ï¼Œå°±åªè¦å…³å¿ƒ $k$ äº†ã€‚

è®¾ $S$ ä¸ºæ»¡è¶³æ¡ä»¶çš„ $k$ çš„ $kX + a$ æ„æˆçš„é›†åˆï¼Œé‚£ä¹ˆ $kX + a \in S\ mod\ p_i$ å˜å½¢ä¸º $k \in S\ mod\ \frac{p_i}{gcd(p_i, X)}$ã€‚æ€ä¹ˆåˆå¹¶è§£é›†å‘¢ï¼Ÿ

å¯¹äºä¸¤ä¸ªåŒä½™æ–¹ç¨‹ï¼Œè®¾è§£é›†åˆ†åˆ«ä¸º $S_1$ å’Œ $S_2$, è‹¥å®ƒä»¬æ¨¡æ•°äº’è´¨ï¼Œåˆ™è§£é›†ä¸º $S_1 \times S_2$ã€‚

æ‰€ä»¥å– $X = lcm(1, \cdots, 10) = 2520$ï¼Œä½ ä¼šå‘ç°ç”±äº $p_i \in [1, 100]$ï¼Œæ‰€æœ‰ $\frac{p_i}{gcd(p_i, X)}$ éƒ½åªæœ‰ä¸€ç§å› æ•°ï¼æ¯ç§è´¨æ•°ä½œä¸ºæ¨¡æ•°çš„è§£é›†å¤§å°ä¹˜èµ·æ¥å°±è¡Œã€‚

æ•°æ®èŒƒå›´å¾ˆå®½ï¼Œå¤§åŠ›ä¸‰é‡å¾ªç¯æšä¸¾ï¼Œå¤æ‚åº¦ $O(100nX)$

[$Code$](https://loj.ac/s/1052240)

### [$Vim$](https://loj.ac/p/2687)

[å¤§ä½¬](https://www.cnblogs.com/Itst/p/10339605.html)

ä¸»è¦è¿˜æ˜¯çœ‹å¤§ä½¬çš„å§ï¼æˆ‘è¯´ç‚¹è‡ªå·±çš„ç†è§£ã€‚dp å¦‚ä½•åˆ’åˆ†é˜¶æ®µï¼Ÿæˆ‘ä»¬è¿˜æ˜¯ä»å·¦å¾€å³ï¼Œè§„å®šï¼šæ¯ä¸ªä½ç½® $i$ çš„è´¡çŒ®æ˜¯ä»å®ƒå‡ºå‘ç›´åˆ°åˆ°è¾¾ä¸‹ä¸€ä¸ªå³è¾¹çš„ä½ç½®çš„æ“ä½œæ•°ï¼ˆå³ä» $i$ å‡ºå‘ï¼Œè·¨è¶Š $[i, i + 1]$ çš„ï¼‰ã€‚è¿™ä¸ªå¯¼è‡´äº†çº¿å¤´ dp çš„ç‰¹ç‚¹ï¼šâ€œè·¯å¾„â€åœ¨ dp è¿‡ç¨‹ä¸­ä¸æ˜¯è¿ç»­çš„ï¼Œè€Œæ˜¯è®¸å¤šä¸ªçº¿å¤´ä¸æ–­å»¶é•¿æ‹¼èµ·æ¥çš„ã€‚

[$Code$](https://loj.ac/s/1053317)

### [ç²¾å‡†é¢„æµ‹](https://loj.ac/p/3101)

æ­£å¸¸åš 2-satï¼Œ$0$ ä¸ºæ­»ï¼Œ$1$ ä¸ºç”Ÿï¼Œæˆ‘ä»¬è¦è®¡ç®—ä» $(0, x, 1)$ åˆ° $(T + 1, y, 1)$ çš„ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯å‡å»åˆ° $(T + 1, y, 0)$ çš„ä¸ªæ•°ï¼Œç”±äºæ˜¯ DAGï¼Œæ‹“æ‰‘ + bitset å³å¯ã€‚æ³¨æ„è¦åˆ¤è‡ªå·±æ˜¯å¦åˆæ³•ã€‚

## $\mathcal{2.2}$
---

### $NOI2017-æ³³æ± $

å†™åœ¨ã€Œçº¿æ€§é€’æ¨å­¦ä¹ ç¬”è®°ã€é‡Œäº†ã€‚

## $\mathcal{2.3}$
---

### ä¹çœè”è€ƒ2018

è¿™ä¸¤å¤©å†™äº† $T1$ ~ $T5$ï¼Œé¢˜è§£åœ¨ã€Œä¹çœè”è€ƒ2018 ä¹±å†™ã€ã€‚

### [$å›´ç»•ç€æˆ‘ä»¬çš„åœ†ç¯$](https://uoj.ac/problem/453)

å•å†™äº†ã€‚

## $\mathcal{2.4}$
---

### [$ -è´­ç¥¨$](https://uoj.ac/problem/7)

$f_i = \min{f_j + (d_i - d_j)p_i + q_i}$, $d_i$ æ˜¯ $i$ åˆ°æ ¹çš„è·ç¦»ã€‚

è¿™å¾ˆæ–œç‡ä¼˜åŒ–ã€‚äºæ˜¯æ¨ä¸€æ³¢å¾—åˆ° $d_j > d_k$ ä¸” $\frac{f_j - f_k}{d_j - d_k} > p_i$ æ—¶ $j$ ä¸€å®šä¸è¢«å–åˆ°ã€‚

ç„¶è€Œå®ƒçœŸçš„èƒ½ç›´æ¥ä¸Šæ–œç‡ä¼˜åŒ–å—= = ä¸è¡Œï¼**å‡¸å£³çš„å¤æ‚åº¦æ˜¯å‡æ‘Šçš„**ï¼Œä½ å¸¦ä¸ªåˆ é™¤å®ƒå°±ä¼ªäº†ã€‚

ä¸€ç­¹è«å±•ã€‚

è€ƒè™‘ä¸€æ¡é“¾çš„æƒ…å†µï¼Œå¯ä»¥ cdq åˆ†æ²»ã€‚è¿™å¯å‘æˆ‘ä»¬ç‚¹åˆ†æ²»â€”â€”æŠŠä¸€ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„åˆ’åˆ†ä¸ºè®¸å¤šæ®µåˆ†æ²»é‡å¿ƒåˆ°åˆ†æ²»å­æ ‘æ ¹çš„è·¯å¾„ï¼Œç»´æŠ¤æ¯ä¸ªåˆ†æ²»é‡å¿ƒåˆ°åˆ†æ²»å­æ ‘æ ¹çš„è·¯å¾„å‡¸å£³ï¼Œä»¥æ›´æ–°åˆ†æ²»å­æ ‘çš„ç­”æ¡ˆã€‚å¤æ‚åº¦ $O(nlog^2n)$ï¼Œç‚¹åˆ†æ²»ä¸€åª logï¼Œå‡¸å£³ä¸ŠäºŒåˆ†ä¸€åª logã€‚

[$Code$](https://uoj.ac/submission/453320)

### [$Ynoi2012-äººç”Ÿå·…å³°$](https://www.luogu.com.cn/problem/P5527)

å°æ¸…æ–°ã€‚å–æ¨¡è¯¶ï¼æ ¹æ®æŠ½å±‰åŸç†ï¼Œ$2^{r - l + 1} > maxV(r - l + 1)$ï¼Œå³ $r - l + 1 > 13$ æ—¶å¿…ç„¶æœ‰è§£ï¼›å‰©ä¸‹æ‹¿ä¸ª bitset dp ä¸€ä¸‹å°±å¥½äº†ã€‚ä¿®æ”¹æ“ä½œå°±é¢„å¤„ç†ç«‹æ–¹ï¼Œæ ‘çŠ¶æ•°ç»„è®°æ“ä½œæ¬¡æ•°ï¼ŒæŸ¥è¯¢æ—¶å€å¢ã€‚

### [çŸ³å®¶åº„çš„å·¥äººé˜¶çº§é˜Ÿä¼æ¯”è¾ƒåšå¼º](https://uoj.ac/problem/272)

å†™åœ¨ã€Œé›†åˆå¹‚çº§æ•°ã€ã€‚

## $\mathcal{2.5}$
---

### [å–‚é¸½å­](https://uoj.ac/problem/449)

æ¯åªé¸½å­éƒ½ç­‰ä»·ï¼Œä¿¡æ¯åªå’Œé›†åˆå¤§å°æœ‰å…³ã€‚

$$ans = \sum\limits_{i = 1}^n (-1)^{i + 1} \binom{n}{i} \frac{n}{i} f_i$$

$f_i$ è¡¨ç¤ºå–‚äº† $i$ åªé¸½å­ï¼Œå…¶ä¸­æ°å¥½æœ‰ä¸€åªåƒäº† $K$ ç²’ç‰ç±³çš„æœŸæœ›æ­¥æ•°ã€‚ä¹˜ $\frac{n}{i}$ æ˜¯ä¸ºäº†æŠŠé›†åˆä»å…¨é›†ç¼©åˆ°é‚£ $i$ åªçš„é›†åˆã€‚

$$f_i = \sum\limits_{j = 0}^{(i - 1)(K - 1)} (j + K) \frac{i \binom{j + K - 1}{j} g_{i - 1, j}}{i^{j + K}}$$

æšä¸¾åˆ†ç»™å…¶ä»–æ²¡å–‚é¥±çš„é¸½å­çš„ç‰ç±³æ•°ã€‚$g_{i, j}$ è¡¨ç¤ºæŠŠ $j$ ç²’ç‰ç±³åˆ†ç»™ $i$ åªé¸½å­ï¼Œæ¯åªåƒçš„ç‰ç±³æ•°å°äº $K$ çš„æ–¹æ¡ˆæ•°ã€‚é’¦å®šæœ€åä¸€ç²’ç‰ç±³ä¸€å®šå–‚ç»™é‚£åªé¥±çš„é¸½å­ã€‚

$$g_{i, j} = (\sum\limits_{t = 0}^{K - 1} \frac{x^t}{t!})^{i} [x^j]$$

å¯ä»¥ NTTï¼Œä¹Ÿå¯ä»¥ dp + ç»„åˆæ•°ç®—ä¸€ä¸‹ï¼Œæ¯æ¬¡åŠ å…¥ä¸€ç²’ç‰ç±³ï¼Œæ–¹æ¡ˆæ•°æ˜¯æ€»æ•°å‡å»ä¼šå–‚é¥±ä¸€åªé¸½å­çš„æ–¹æ¡ˆæ•°ã€‚$O(n^2K)$ã€‚~~å¯æ˜¯ NTT è¦ $O(n^2KlognK)$~~

[$Code$](https://uoj.ac/submission/453568)

[å¦ä¸€ç§ $O(n^2K)$ ç¥ä»™æ–¹æ³•](https://www.luogu.com.cn/paste/yyell4b7)

## $\mathcal{2.6}$
---

### [å¤è¯»æœº](https://uoj.ac/problem/450)

ä¸éš¾çœ‹å‡ºæ±‚çš„å°±æ˜¯ $n!(\sum\limits_{i = 0}^{\lfloor \frac{n}{d} \rfloor} \frac{x^{id}}{(id)!})^K [x^n]$ã€‚$d$ å¥½å°ï¼Œæœ‰è¯¡ï¼

$d = 1$, $ans = K^n$

$d = 2$, å¯ä»¥ç›´æ¥ç”¨ $\frac{e^x + e^{-x}}{2}$

$$ans = n!(\frac{e^x + e^{-x}}{2})^K[x^n]$$

$$= \frac{n!}{2^K} \sum\limits_{i = 0}^K \binom{K}{i} e^{(2i - K)x} [x^n]$$

$$= \frac{\sum\limits_{i = 0}^K \binom{K}{i} (2i - K)^n}{2^K}$$

$d = 3$, å•ä½æ ¹åæ¼”.

$$ans = n!(\sum\limits_{i = 0}^n [3 \mid i] \frac{x^i}{i!})^K [x^n]$$

$$= n!( \sum\limits_{i = 0}^n \frac{1}{3} \sum\limits_{j = 0}^2 \omega_3^{ij} \frac{x^i}{i!} )^K [x^n]$$

$$= \frac{n!}{3^K}( \sum\limits_{j = 0}^2 e^{\omega_3^jx} )^K [x^n]$$

äºŒé¡¹å¼å±•å¼€

$$= \frac{n!}{3^K} \sum\limits_{i = 0}^K \binom{K}{i} \sum\limits_{j = 0}^{K - i} \binom{K - i}{j} e^{(i + j\omega_3^1 + (K - i - j)\omega_3^2)x} [x^n]$$

$$= \frac{1}{3^K}\sum\limits_{i = 0}^K \binom{K}{i} \sum\limits_{j = 0}^{K - i} \binom{K - i}{j} (i + j\omega_3^1 + (K - i - j)\omega_3^2)^n$$

ç›´æ¥ $K^2$ã€‚

[$Code$](https://uoj.ac/submission/453603)

### [LJJ å­¦äºŒé¡¹å¼å®šç†](http://loj.ac/p/6485)

æ»¡æ»¡çš„å¥—è·¯å•Š= = å¥½åƒè¿ç”Ÿæˆå‡½æ•°éƒ½æ²¡ç”¨åˆ°

$$\sum\limits_{i = 0}^n \binom{n}{i} s^i a_{i\ mod\ 4} = \sum\limits_{t = 0}^3 a_t \sum\limits_{i = 0}^{n} [4 \mid i - t] \binom{n}{i} s^i$$

$$= \sum\limits_{t = 0}^3 a_t \sum\limits_{i = 0}^n \frac{1}{4} \sum\limits_{j = 0}^3 \omega_4^{(i - t)j} \binom{n}{i} s^i = \frac{1}{4} \sum\limits_{t = 0}^3 a_t \sum\limits_{j = 0}^3 \sum\limits_{i = 0}^n \omega_4^{ij}s^i\binom{n}{i}$$

$$= \frac{1}{4} \sum\limits_{t = 0}^3 a_t \sum\limits_{j = 0}^3 \frac{(\omega_4^js + 1)^n}{\omega_4^{tj}}$$

[$Code$](https://loj.ac/s/1059309)

WC å‡ºæˆç»©äº†ï¼Œäººéƒ½ä¸æƒ³åŠ¨ã€‚ã€‚ã€‚æ²¡æœ‰é“¶è¯¶ã€‚ã€‚è¢«è‡ªå·±èœå‚»äº†ï¼ŒT1 åšè¿‡ç±»ä¼¼çš„ /kk ç„¶è€Œå½“æ—¶è„‘å­é‡Œä¸€é—ªè€Œè¿‡ã€‚è¿˜æ˜¯çŸ¥è¯†ä½“ç³»å¤ªçƒ‚äº†ã€‚è¦åš CF æ‚é¢˜ï¼Œç»¼åˆé¢˜ä¸æƒ³æ”¾ä¹Ÿå¯ä»¥åšï¼Œä½†æ˜¯è¦é”»ç‚¼æ€ç»´æ¨¡å¼ï¼Œä¸ç„¶æ°¸è¿œæ˜¯ä¸ªæš´åŠ›é€‰æ‰‹ /kel

### $XJOI1656$

#### $T1$

ç‚¹å‡è¾¹ã€è¾¹çš„ä¿¡æ¯æ”¾çˆ¶äº²ä¸Šâ€”â€”è¿˜å·®ä¸€ä¸ªå¥—è·¯ï¼šç‚¹åˆ†æ ‘ã€‚åšå®Œäº†ã€‚

#### $T2$

å¡åœ¨é¢„å¤„ç†â€œä¸€ä¸ªäººä¸ç¢°åˆ°ä¸€æ¡çº¿çš„èµ°â€ä¸Šäº†ã€‚è¿™å°±æ˜¯ä¸ªå¡ç‰¹å…°æ•°ï¼Œä½ æŠŠæœå·¦èµ°å’Œæœå³èµ°åˆ†åˆ«çœ‹æˆæœå³èµ°å’Œæœä¸Šèµ°å°±æ˜¯ä¸ªèµ°ç½‘æ ¼é—®é¢˜äº†ï¼Œç„¶åå…³äºçº¿å¯¹ç§°ä»€ä¹ˆçš„åšä¸€åšã€‚æ¦‚ç‡å°±æ˜¯æ¥ç³Šå¼„ä½ çš„ã€‚$O(nm^2)$ è¶³çŸ£ã€‚

#### $T3$

å¹³é¢å›¾æœ€çŸ­è·¯è½¬å¯¹å¶å›¾æœ€å°å‰²ï¼Œè¿™æ ·é™åˆ¶å°±å¯ä»¥ç”¨ç½‘ç»œæµçš„æ–¹å¼è§£å†³ï¼ˆé™åˆ¶æŸæ¡è¾¹å¿…é¡»ä¸é€‰å°±æ˜¯é™åˆ¶å¯¹å¶å›¾çš„æŸä¸¤ä¸ªç‚¹å¿…é¡»åœ¨åŒä¸ªé›†åˆé‡Œï¼Œåå‘ $\infty$ è¾¹ï¼‰

### [$CF878D$](https://www.luogu.com.cn/problem/CF878D)

ç¥é¢˜ã€‚å¦‚æœæ˜¯ $01$ å°±ç›´æ¥ bitset å–å¹¶/å–äº¤äº†ã€‚ä»¤ $f_{i, s}$ è¡¨ç¤º $s$ é›†åˆé‡Œçš„ç”Ÿç‰©æ˜¯å¦å­˜åœ¨ä¸€ä¸ªå±æ€§ $\geq$ $i$ å·ç”Ÿç‰©çš„å¯¹åº”å±æ€§ã€‚ä»¥å– $\max$ æ“ä½œä¸ºä¾‹ï¼Œ$c \geq \max(a, b)$ å½“ä¸”ä»…å½“ $c \geq a$ ä¸” $c \geq b$ï¼Œæ‰€ä»¥æ˜¯å–äº¤ï¼›åŒç†ï¼Œå– $\min$ å°±æ˜¯å–å¹¶ã€‚bitset åŠ é€Ÿå³å¯ã€‚

å¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨äºŒåˆ†çš„æ€æƒ³, $\geq lim$ çš„ä¸º $1$ï¼Œ$< lim$ çš„ä¸º $0$ï¼Œé‚£ä¹ˆ $\max$ ä¸ºå–å¹¶ï¼Œ$\min$ ä¸ºå–äº¤ã€‚

å­¦ä¹ ã€ŒäºŒæ¬¡ç¦»çº¿è«é˜Ÿã€ã€‚

è®¢æ­£ä»Šå¤© T1ã€T2ã€T3ã€‚

## æ„Ÿè§‰è‡ªå·±æ‚é¢˜çœŸåšå¤ªå°‘äº†ï¼Œæ•°å­¦çœŸå­¦å¤ªå°‘äº†ï¼Œå…¶ä»–çš„åŸºç¡€å·®ä¸å¤šéƒ½æŒæ¡äº†ã€‚ä»¥åå°±å¾€è¿™ä¸¤ä¸ªæ–¹å‘åŠªåŠ›å§ï¼

## $\mathcal{2.7}$
---

### [$ZJOI2018-$å†å²](https://uoj.ac/problem/374)

å•å†™äº†ã€‚éå¸¸nbçš„é¢˜ã€‚

### [WC2020]-çŒœæ•°æ¸¸æˆ

éƒ½ 1202 å¹´äº†ä¸ä¼šæœ‰äºº 0202 å¹´çš„ WC è¿˜æ²¡è¡¥å§ä¸ä¼šå§ä¸ä¼šå§ï¼ˆx

å’•å’•

### [WC2021]-æ–æ³¢é‚£å¥‘

éƒ½ 1202 å¹´äº†ä¸ä¼šæœ‰äººè¿˜å­¦ä¸ä¼šæ•°å­¦å§ä¸ä¼šå§ä¸ä¼šå§ï¼ˆx

å’•å’•

å­¦äº†ã€Œçº¿æ®µæ ‘åˆ†æ²»ã€ã€‚ä¸€ä¸ªä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰ä¸“å±ç§°è°“çš„ä¸œè¥¿ã€‚

## $\mathcal{2.8}$
---

8 å·å•¦ å¯’å‡ï¼å¯’å‡ï¼å¯’å‡ï¼å°æç´ è¿åŠ¨ åŸŸå æ¨¡æ‹Ÿèµ› å¹´è´§ é¸¡é¸­é±¼é¹…è‚‰ç™½åˆ‡è‚‰ç‚¸æ˜¥å·å‡‰æ‹Œæµ·èœ‡çš® æ˜¥æ™š å®ƒä»¬æ¥äº†ï¼ï¼ï¼

å†™äº†ã€Œçº¿æ®µæ ‘åˆ†è£‚ã€ã€‚

### [WD ä¸åœ°å›¾](https://www.luogu.com.cn/problem/P5163)

å˜´ä¸æ¸…æ¥šäº† /kk

åˆ’é‡ç‚¹ï¼Œ**SCC**ï¼Œä¸æ˜¯æ— å‘å›¾çš„è¿é€šåˆ†é‡ã€‚

è€ƒè™‘æ—¶å…‰å€’æµï¼Œåè½¬æ—¶é—´è½´ã€‚

æˆ‘ä»¬å…³æ³¨çš„å…¶å®æ˜¯ç‚¹ã€‚æ˜¯æ¯æ¡è¾¹çš„**ä¸¤ä¸ªç«¯ç‚¹**ä»€ä¹ˆæ—¶å€™å¼€å§‹å¤„äºåŒä¸€ä¸ª SCC ä¸­ã€‚å¦‚æœæ±‚å‡ºäº†è¿™ä¸ªæ—¶é—´ï¼Œå°±åªè¦ä»æ™šåˆ°æ—©åšä¸€éæƒå€¼çº¿æ®µæ ‘åˆå¹¶ã€‚ç°åœ¨è¦æ±‚è¿™ä¸ªæ—¶é—´ã€‚

æ€ä¹ˆå¿«é€ŸæŸ¥è¯¢ä¸¤ç‚¹æ˜¯å¦åœ¨åŒä¸ª SCC é‡Œï¼Ÿå¹¶æŸ¥é›†ï¼Œè¿˜è¦æ”¯æŒæ’¤é”€ã€‚

è€ƒè™‘æ•´ä½“äºŒåˆ†ã€‚è¦æ‰¾æ¯å¯¹ç‚¹å‡ºç°åœ¨åŒä¸ª SCC ä¸­çš„æœ€æ™šæ—¶é—´ï¼Œå°±åŠ  $[mid + 1, r]$ çš„è¾¹â€”â€”å‡†ç¡®æ¥è¯´ï¼Œæ˜¯åœ¨åœ¨å·²æœ‰çš„ SCC åŸºç¡€ä¸Šâ€”â€”å¦‚æœè¦åŠ å…¥ä¸€æ¡è¾¹ $(x, y)$ï¼Œé‚£å®é™…åŠ å…¥çš„æ˜¯ $(getfa(x), getfa(y))$ï¼Œå¹¶ä¸” tarjan ä¹Ÿåªè·‘è¿™ä¸€è½®åŠ å…¥çš„ SCC é—´è¾¹ã€‚è·‘å®Œ tarjanï¼ŒæŠŠå·²ç»åœ¨ä¸€ä¸ª SCC çš„ç‚¹å¯¹å¾€å³ä¸¢ï¼Œè¿˜æ²¡åœ¨ä¸€ä¸ª SCC çš„ç‚¹å¯¹å¾€å·¦ä¸¢ã€‚åˆ†ç±»å®Œ $[l, r]$ çš„è¾¹åï¼Œå…ˆå¾€ $[l, mid]$ é€’å½’ï¼ˆæ’¤æ‰è¾¹ï¼Œä¸æ’¤å¹¶æŸ¥é›†ï¼‰ä»¥åˆ©ç”¨ä¸Šä¸€å±‚ä¸­å·²åŠ çš„ $[mid + 1, r]$ çš„è¾¹ï¼Œç„¶åå†æ’¤é”€å¹¶æŸ¥é›†å¹¶é€’å½’ $[mid + 1, r]$ã€‚è¿™æ ·æ¯æ¡è¾¹è¢«æ“ä½œ $logn$ æ¬¡ã€‚

~~æˆ‘æ„Ÿè§‰å…ˆå³å†å·¦å¥½åƒå¤æ‚åº¦ä¹Ÿæ˜¯å¯¹çš„ï¼Œä½†æ˜¯è¦é‡æ–°åŠ ä¸€éï¼Œéº»çƒ¦~~

tarjan $O(m)$ï¼Œå¯æ’¤é”€å¹¶æŸ¥é›† $O(logn)$ï¼Œæ•´ä½“äºŒåˆ†å°±æ˜¯ $O(m log^2n)$ çš„ã€‚çº¿æ®µæ ‘åˆå¹¶ä¸€åª log éå¸¸æ„‰å¿«ã€‚

ä»£ç å¤ªtméš¾å†™äº†ã€‚ã€‚ã€‚é‡æ„ $* n$ï¼Œå°è£…å¤§æ³•å¥½å•Šã€‚

<details>
    <summary>ä»¤äººçª’æ¯çš„code</summary>
    ``` c++
    #include <bits/stdc++.h>
    #define rep(i, x, y) for (int i = x; i <= y; i++)
    #define fi first
    #define se second
    #define pb push_back
    #define mkp make_pair
    #define mid ((l + r) >> 1)
    #define int long long
    using namespace std;

    typedef long long ll;
    typedef pair<int, int> pii;
    const int N = 4e5 + 10, inf = 1e9 + 1e3;
    int n, m, Q;
    int a[N];
    struct Ques {
        int op, x, y;
    } q[N];
    struct Edge {
        int x, y, t;  // å‡ºç°æ—¶é—´
        friend bool operator < (Edge a, Edge b) { return a.t < b.t; }
    } e[N];
    map<pii, int> id;

    namespace INIT {
        void solve() {
            cin >> n >> m >> Q;
            rep(i, 1, n) {
                scanf("%lld", &a[i]);
            }
            rep(i, 1, m) {
                scanf("%lld%lld", &e[i].x, &e[i].y);
                e[i].t = Q;
                id[mkp(e[i].x, e[i].y)] = i;
            }
            rep(i, 1, Q) {
                scanf("%lld%lld%lld", &q[i].op, &q[i].x, &q[i].y);
                if (q[i].op == 1) e[id[mkp(q[i].x, q[i].y)]].t = i - 1;
                if (q[i].op == 2) a[q[i].x] += q[i].y;
            }
        }
    }

    namespace Sol1 {
        int p[N], cnt, now;
        struct atom { int x, y, t; };
        struct DSU {
            int fa[N], sz[N];
            vector<atom> stk;
            DSU() {
                rep(i, 0, N - 1) fa[i] = i, sz[i] = 1;
            }
            int getfa(int x) {
                return fa[x] == x ? x : getfa(fa[x]);
            }
            void merge(int x, int y) {
                x = getfa(x), y = getfa(y);
                if (x == y) return;
                if (sz[x] > sz[y]) swap(x, y);
                stk.pb((atom){x, y, now});
                fa[x] = y, sz[y] += sz[x];
            }
            void undo(int t) {
                while (stk.size() && stk.back().t == t) {
                    atom o = stk.back(); stk.pop_back();
                    fa[o.x] = o.x, sz[o.y] -= sz[o.x];
                }
            }
        } dsu;  // æ­¤å¤„å¹¶æŸ¥é›†ç»´æŠ¤ SCC

        vector<int> g[N];
        int dfn[N], low[N], ins[N], st[N], top, Dfn;
        void tarjan(int x) {
            dfn[x] = low[x] = ++Dfn;
            st[++top] = x, ins[x] = 1;
            for (int i = 0; i < g[x].size(); i++) {
                int y = g[x][i];
                if (!dfn[y]) {
                    tarjan(y);
                    low[x] = min(low[x], low[y]);
                } else if (ins[y]) {
                    low[x] = min(low[x], dfn[y]);
                }
            }
            if (low[x] == dfn[x]) {
                while (st[top] != x) {
                    ins[st[top]] = 0, dsu.merge(st[top], x), --top;
                } if (st[top] == x) ins[x] = 0, --top;
            }
        }

        Edge e1[N], e2[N];
        void solve(int l, int r, int L, int R) {
            if (L > R) return;
            if (l == r) {
                rep(i, L, R) e[i].t = l;
                return;
            }
            int ori = ++now, lst = cnt;
            rep(i, L, R) {
                int x = dsu.getfa(e[i].x), y = dsu.getfa(e[i].y);
                if (x != y && e[i].t > mid) {
                    g[x].pb(y);
                    p[++cnt] = x, p[++cnt] = y;
                }
            }
            Dfn = 0;
            rep(i, lst + 1, cnt)
                if (!dfn[p[i]]) tarjan(p[i]);
            int t1 = 0, t2 = 0;
            rep(i, L, R) {
                if (dsu.getfa(e[i].x) == dsu.getfa(e[i].y) && e[i].t > mid) e2[++t2] = e[i];
                else e1[++t1] = e[i];
            }
            rep(i, 1, t1) e[L + i - 1] = e1[i];
            rep(i, 1, t2) e[L + t1 + i - 1] = e2[i];
            rep(i, lst + 1, cnt)
                g[p[i]].clear(), dfn[p[i]] = low[p[i]] = 0, p[i] = 0;
            cnt = lst;
            solve(l, mid, L, L + t1 - 1);
            dsu.undo(ori);
            solve(mid + 1, r, L + t1, R);
        }
    }

    namespace Sol2 {
        struct SGT {
            #define D N * 22
            int idx, ls[D], rs[D], sz[D];
            ll sum[D];
            void modify(int &x, int l, int r, int p, int v) {
                if (!x) x = ++idx;
                sum[x] += v * p, sz[x] += v;
                if (l == r) return;
                p <= mid ? modify(ls[x], l, mid, p, v) : modify(rs[x], mid + 1, r, p, v);
            }
            ll query(int x, int l, int r, int k) {
                if (!x || !k) return 0;
                if (l == r) return min(k, sz[x]) * l;
                // if (sz[x] <= k) return sum[x];  // è¿™é‡Œä¸ºä»€ä¹ˆä¸å¯¹å•Š /kk æ‘¸ä¸ç€å¤´å‘
                if (sz[rs[x]] <= k) return sum[rs[x]] + query(ls[x], l, mid, k - sz[rs[x]]);
                else return query(rs[x], mid + 1, r, k);
            }
            void merge(int &x, int y) {
                if (!x || !y) { x += y; return; }
                if (!x) x = ++idx;
                sum[x] += sum[y], sz[x] += sz[y];
                merge(ls[x], ls[y]), merge(rs[x], rs[y]);
            }
        } seg;
        int rt[D];
        struct DSU {
            int fa[N];
            DSU() {
                rep(i, 0, N - 1) fa[i] = i;
            }
            int getfa(int x) {
                return fa[x] == x ? x : fa[x] = getfa(fa[x]);
            }
            void merge(int x, int y) {
                x = getfa(x), y = getfa(y);
                if (x == y) return;
                fa[y] = x, seg.merge(rt[x], rt[y]);
            }
        } dsu;
        ll ans[N];
        void solve() {
            memset(rt, 0, sizeof(rt));
            rep(i, 1, n) seg.modify(rt[i], 0, inf, a[i], 1);
            sort(e + 1, e + m + 1);
            int pos = m + 1;
            for (int i = Q; i; --i) {
                if (q[i].op == 1) continue;
                while (pos > 1 && e[pos - 1].t >= i) {
                    --pos, dsu.merge(e[pos].x, e[pos].y);
                }
                int x = dsu.getfa(q[i].x);
                if (q[i].op == 2) {
                    seg.modify(rt[x], 0, inf, a[q[i].x], -1);
                    a[q[i].x] -= q[i].y;
                    seg.modify(rt[x], 0, inf, a[q[i].x], 1);
                } else {
                    ans[i] = seg.query(rt[x], 0, inf, q[i].y);
                }
            }
            rep(i, 1, Q) if (q[i].op == 3) printf("%lld\n", ans[i]);
        }
    }

    signed main() {
        INIT::solve();
        Sol1::solve(0, Q, 1, m);
        Sol2::solve();
        return 0;
    }
    ```
</details>

# å¯’å‡~

## *å…»ç”Ÿå®å½•*

è®¡åˆ’ï¼

### ğŸƒâ€â™€ï¸ğŸŠâ€â™€ï¸

<table border="1">
  <tr>
    <th>Date</th>
    <td>2.9</td>
    <td>2.10</td>
    <td>2.11</td>
    <td>2.12</td>
    <td>2.13</td> 
    <td>2.14</td>
    <td>2.15</td>
    <td>2.16</td>
    <td>2.17</td>
  </th>
  <tr>
    <th></th>
    <td></td>
    <td>1.5km</td>
    <td>30min</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </th>
</table>

### é˜…è¯»

<table border="1">
  <tr>
    <td>ã€Šç›ä¸½ã€‹</td>
    <td>ã€Šå¾®æš—çš„ç«ã€‹</td>
  </th>
  <tr>
    <td></td>
    <td></td>
  </th>
</table>

&radic;

### å°æç´

### åŸŸå
:(
    
### whk
ä½œä¸šå¹²å®Œäº†

### å…·ä½“æ•°å­¦

## *è®­ç»ƒå®å½•*

æ‰“ vp åšæ‚é¢˜ / åšé›†è®­é˜Ÿä½œä¸šé¢˜ã€æ¸…åé›†è®­é¢˜ã€‚

å­¦ä¹  BSGSã€‚

å­¦ä¹ æè¶…çº¿æ®µæ ‘ã€‚

å­¦ä¹ å¤šå…ƒæ‹‰åã€‚

å†™ Ynoiã€‚

åš LCTã€‚

gym102759G

## $\mathcal{2.9}$
---

## $\mathcal{2.10}$
---

### T2. Gym102759H

é€†å‘æ€ç»´ï¼Œè€ƒè™‘ä¸€ä¸ª k å˜æˆ [0, k - 1]ï¼Œk - 1 å†å˜æˆ [0, k - 2]... è€Œä¸€ä¸ª 0 å¯ä»¥å˜æˆä»»æ„æ•´æ•°ã€‚è€ƒè™‘å°½é‡å¾€ 0 å˜ï¼Œ

T3: s[1, i] -> s[1, p(i)]
1. p(i) <= i / 2 (logn æ¬¡)
2. p(i) è¾ƒå¤§
    å½¢æˆ i - p(i) çš„å‘¨æœŸ