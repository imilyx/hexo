---
title: 组合数学
date: 2018-06-01 19:44:40
tags:
    - 组合数学
mathjax: true
---

### 错排公式
------------

求解 n 个相异的元素排成一排 p1, p2, ... pn，pi 不在第 i 位的方案数。

解法：设 $D(i)$ 表示有 $n = i$ 时的方案数。
若 n 排在第 k 位，k 排在第 n 位，则有 $D(n - 2)$ 的方案数。又因 k 有 $n - 1$ 种取值，故有 $(n - 1)(D(n - 2))$ 种方案数。
若 n 排在第 k 位，第 n 位的不是 k， 则除 n 外有一个 $n - 1$ 的错排， k 有 $n - 1$ 种取值，故有 $(n - 1)(D(n - 1))$ 种方案数。
结论：$D(i) = (n - 1)(D(n - 2) + D(n - 1))$



### 斯特林数（Stirling数）
-----------------------

Stirling数可指两类数，第一类Stirling数和第二类Stirling数。

先来介绍第一类Stirling数，我们称它为 $S1(n, m)$ ，表示将 n 个不同元素构成 m 个圆排列的方案数。
怎么求解？正如错排公式求解那样，组合数学多以递归证明为主，且我们考虑最后加进来的元素方案。
第一种情况，最后加进来的元素 x 自成一个圆排列，方案数为 $S1(n - 1, m - 1)$ ；
第二种情况，将 x 插入任意一个现有的圆排列，又因是圆排列，有 $n - 1$ 个元素的后面可以放置 x，故方案数为 $(n - 1) * S1(n - 1, m)$ 。
综上所述，$S1(n, m) = S1(n - 1, m - 1) + (n - 1) * S1(n - 1, m)$

再来讲讲第二类Stirling数，我们称它为 $S2(n, m)$ , 表示将 n 个不同元素构成 m 个无序集合的方案数。
同样考虑新最后加进来的元素 x。
第一种情况，x 自成一个集合，方案数为 $S2(n - 1, m - 1)$ ；
第二种情况，将 x 插入到任意一个集合，有 m 个集合，故方案数为 $m * S2(n - 1, m)$ 。
综上所述，$S2(n, m) = S2(n - 1, m - 1) + m * S2(n - 1, m)$



### 习题
-------

有一个 n 个数的序列，将元素两两配对，求方案数。（可以单个一组）
例：(1, 3)(2, 5)(4)  (1, 2)(3, 4)(5, 6)

设 $F(n)$ 为 n 个数的序列的方案数。考虑最后加入的元素 x。
若 x 不配对，单个一组，有方案数 $F(n - 1)$ 。
若 x 配对，则有 $n - 1$ 个选择，剩下 $n - 2$ 个元素，故有方案数 $(n - 1)F(n - 2)$ 。
综上所述，$F(n) = F(n - 1) + (n - 1) * F(n - 2)$

Hint: 可别将 $F(n)$ 与错排公式记错了！



### Catalan数
-------------

$C(n) = \binom{2n}{n} - \binom{2n}{n + 1} = \frac{\binom{2n}{n}}{n + 1}$