---
title: ã€å­¦ä¹ ç¬”è®°ã€‘é›†åˆå¹‚çº§æ•°
date: 2020-08-07 20:05:40
tags: 
    - å­¦ä¹ ç¬”è®°
    - é›†åˆå¹‚çº§æ•°
mathjax: true
encrypt: true
---

```
æ‰“å¼€äº†æ–°ä¸–ç•Œçš„å¤§é—¨ã€‚
```

æŠ½ä¸ªæ—¶é—´è¡¥ä¸€ä¸‹ ~ ä¸å†™ç‚¹ä»€ä¹ˆè¿™ç©æ„å¾ˆå¿«å°±åœ¨å¤§è„‘é‡Œå°±å˜æˆé»‘ç®±å­äº†ã€‚

## FMT
---

ç”¨æ¥è®¡ç®—é›†åˆå¹‚çº§æ•°ä¹˜æ³•ã€‚è¿˜æœ‰ä¸€ç§åˆ†æ²»ä¹˜æ³•ï¼Œæœ¬è´¨ç›¸åŒã€‚

FMT: $\hat{f_S} = \sum\limits_{T \subseteq S} f_T$

FMIï¼š$f_S = \sum\limits_{T \subseteq S} (-1)^{|S| - |T|} \hat{f_T}$

ï¼ˆå­é›†åæ¼”å°±æ˜¯ FMT å’Œ FMIï¼‰

ä¸€ä¸ªé›†åˆå¹‚çº§æ•°æœ‰é€†å…ƒå½“ä¸”ä»…å½“ FMT åæ‰€æœ‰ç³»æ•°å‡ä¸ä¸º $0$ã€‚

ç±»ä¼¼ FFT å¸¦ $n$ æ¬¡å•ä½æ ¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä½œå¾€é‡Œå¸¦äº†ä¸€å †ç‰¹å¾å‘é‡æœ€åæ’å€¼æ’äº†å›æ¥ã€‚ä½†æ˜¯ç”±äºåšä¸»è¿‡èœï¼Œè®ºæ–‡è¿™éƒ¨åˆ†æ²¡çœ‹å¤ªæ‡‚ã€‚ã€‚

## Xor å·ç§¯â€”â€”FWT
---

upd: æ›´å»ºè®®çœ‹ $k$ è¿›åˆ¶ FWT å¤„çš„ $w$ æ„é€ 

æœ‰ç»“è®ºï¼šå¯¹äºä¸€ä¸ªé›†åˆ $S$ æœ‰ $\frac{1}{2^n} \sum\limits_{T \subseteq 2^U}(-1)^{|S\cap T|} = [S = \emptyset]$ï¼Œè¯æ˜è€ƒè™‘ $S$ ä¸ä¸ºç©ºæ—¶ä» $S$ é‡Œæ‹èµ°ä¸€ä¸ªæ•°å $-1$ çš„æ­£è´Ÿæ€§æ”¹å˜ï¼Œä¸æ‹èµ°å‰çš„æŠµæ¶ˆã€‚

é‚£ä¹ˆå¯¹äºå¼‚æˆ–å·ç§¯ $h_S = \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \oplus R = S] f_Lg_R$ å°±æœ‰æ–°çš„æ€è·¯ï¼š

$$h_S = \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \oplus R \oplus S = \emptyset] f_Lg_R$$

$$= \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} \frac{1}{2^n} \sum\limits_{T \subseteq 2^U} (-1)^{|T \cap (L \oplus R \oplus S)|} f_Lg_R$$

$$= \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} \frac{1}{2^n} \sum\limits_{T \subseteq 2^U} (-1)^{|T \cap L|} (-1)^{|T \cap R|} (-1)^{|T \cap S|} f_Lg_R$$

$$= \frac{1}{2^n} \sum\limits_{T \subseteq 2^U} (-1)^{|T \cap S|} ( \sum\limits_{L \subseteq 2^U} (-1)^{|T \cap L|} f_L ) ( \sum\limits_{R \subseteq 2^U} (-1)^{|T \cap R|} g_R )$$

äºæ˜¯å®šä¹‰ FWTï¼š$\hat{f_S} = \sum\limits_{T \subseteq 2^U} (-1)^{|T \cap S|} f_T$

IFWTï¼š$\hat{f_S} = \frac{1}{2^n} \sum\limits_{T \subseteq 2^U} (-1)^{|T \cap S|} f_T$

<details>
    <summary>FWT_xor</summary>
    ``` c++
    void FWT_xor(ll a[], int op = 1) {
        rep(i, 1, n)
            rep(j, 0, (1 << n) - 1)
                if (!((j >> (i - 1)) & 1)) {
                    ll x = a[j], y = a[j + (1 << (i - 1))];
                    a[j] = (x + y) % mod, a[j + (1 << (i - 1))] = (x - y + mod) % mod;
                    if (op == -1) (a[j] *= inv2) %= mod, (a[j + (1 << (i - 1))] *= inv2) %= mod;
                }
    }
    ```
</details>

## Or å’Œ And å·ç§¯â€”â€”FMT
---

ä»¥ Or ä¸ºä¾‹ï¼š

$$h_S = \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \cup R = S] f_Lg_R$$

å¯¹ä¸¤è¾¹åŒæ—¶åš FMT

$$\hat{h_S} = \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \cup R \subseteq S] f_Lg_R$$

$$= \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \subseteq S][R \subseteq S] f_Lg_R$$

**FMT æœ¬è´¨æ˜¯é«˜ç»´å‰ç¼€å’Œã€‚** 

And å·ç§¯å–åååš Or å·ç§¯å†å–åä¹Ÿæ˜¯å¯è¡Œçš„ qwqã€‚å½“ç„¶ä¹Ÿæœ‰æœ´ç´ çš„åˆ†æ²»ä¹˜æ³•ã€‚

<details>
    <summary>FWT_or, and, FMT</summary>
    ``` c++
    void FWT_or(ll a[], int op = 1) {
        for (int k = 1; k < (1 << n); k <<= 1)
            for (int i = 0; i < (1 << n); i += (k << 1))
                for (int j = 0; j < k; ++j)
                    a[i + j + k] = (a[i + j + k] + a[i + j] * op + mod) % mod;
    }
    void FWT_and(ll a[], int op = 1) {
        for (int k = 1; k < (1 << n); k <<= 1)
            for (int i = 0; i < (1 << n); i += (k << 1))
                for (int j = 0; j < k; ++j)
                    a[i + j] = (a[i + j] + a[i + j + k] * op + mod) % mod;
    }
    // FMT(= FWT_and)
    void FMT(int op = 1) {
        rep(i, 1, n)
            rep(j, 0, (1 << n) - 1)
                if ((j >> (i - 1)) & 1)
                    f[j] = (f[j] + f[j - (1 << (i - 1))] * op + mod) % mod;
    }
    ```
</details>

## å­é›†å·ç§¯
---

$$\hat{h_S} = \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \cup R = S] [L \cap R = \emptyset] f_Lg_R$$

ç›´æ¥æšä¸¾å­é›† $3^n$ã€‚

$[L \cup R = S] [L \cap R = \emptyset] = [L \cup R = S][|L| + |R| = |S|]$ï¼Œè®°å½•ä¸€ä¸ªå ä½æ•°é‡ï¼Œåˆ†å±‚åš or å·ç§¯ã€‚åº”è¯¥æ»¡è¶³ $1$ çš„ä¸ªæ•°æ°å¥½ä¸ºä¸¤è€…ä¹‹å’Œï¼Œ**å¦åˆ™æ¸…ç©º**ã€‚$O(n^22^n)$

### [å·åŒºåˆ’åˆ†ï¼ˆå­é›†å·ç§¯æ¨¡æ¿ï¼‰](https://loj.ac/p/2340)

<details>
    <summary>code</summary>
    ``` c++
    #include <bits/stdc++.h>
    #define rep(i, x, y) for (int i = x; i <= y; i++)
    using namespace std;

    const int mod = 998244353, N = 25, M = (1 << 21);
    typedef long long ll;
    ll n, m, p;
    ll w[N], num[M], sum[M], f[N][M], g[N][M], fa[N];
    vector<int> G[N];

    ll quick_pow(ll a, ll b) {
        ll ret = 1;
        for (; b; b >>= 1) {
            if (b & 1) ret = ret * a % mod;
            a = a * a % mod;
        } return ret;
    }

    void FWT_or(ll a[], int op) {
        rep(i, 1, n)
            rep(j, 0, (1 << n) - 1)
                if ((j >> (i - 1)) & 1)
                    a[j] = ((a[j] + a[j - (1 << (i - 1))] * op) % mod + mod) % mod;
    }

    int getfa(int x) {
        return fa[x] == x ? x : fa[x] = getfa(fa[x]);
    }

    bool chk(int s) {
        rep(i, 1, n) fa[i] = i;
        rep(x, 1, n) if ((s >> (x - 1)) & 1) {
            for (int i = 0; i < G[x].size(); i++) {
                int y = G[x][i];
                if ((s >> (y - 1)) & 1) {
                    int xx = getfa(x), yy = getfa(y);
                    if (xx != yy) fa[xx] = yy;
                }
            }
        }
        int cnt = 0;
        rep(i, 1, n) if ((s >> (i - 1)) & 1) cnt += fa[i] == i;
        return cnt > 1;
    }

    int main() {
        cin >> n >> m >> p;
        rep(i, 1, m) {
            int x, y; scanf("%d%d", &x, &y);
            G[x].push_back(y), G[y].push_back(x);
        }
        rep(i, 1, n) scanf("%lld", &w[i]);
        rep(s, 0, (1 << n) - 1) {
            bool flag = 0;
            rep(x, 1, n) if ((s >> (x - 1)) & 1) {
                int deg = 0;
                for (int i = 0; i < G[x].size(); i++)
                    deg += (s >> (G[x][i] - 1)) & 1;
                if (deg & 1) flag = 1;
                sum[s] += w[x], num[s]++;
            }
            if ((flag || chk(s)) && num[s] > 1) g[num[s]][s] = quick_pow(sum[s], p);
        }
        rep(i, 0, n) FWT_or(g[i], 1);
        f[0][0] = 1; FWT_or(f[0], 1);
        rep(i, 1, n) {
            rep(j, 1, i) {
                rep(s, 0, (1 << n) - 1)
                    f[i][s] = (f[i][s] + 1ll * f[i - j][s] * g[j][s] % mod) % mod;
            }
            FWT_or(f[i], -1);
            rep(s, 0, (1 << n) - 1)
                if (num[s] == i) f[i][s] = (f[i][s] * quick_pow(quick_pow(sum[s], p), mod - 2)) % mod;
                else f[i][s] = 0;  // !!!
            if (i < n) FWT_or(f[i], 1);
        }
        printf("%lld\n", f[n][(1 << n) - 1]);
        return 0;
    }
    ```
</details>

## æ‹“å±•ï¼ˆ$K$ è¿›åˆ¶å¼‚æˆ–å·ç§¯ï¼‰
---

updï¼šåŸæ¥å†™çš„åˆ äº†â€¦â€¦ è®²ä¸æ˜ç™½ï¼Œå¤è¯»æ²¡æ„æ€ï¼Œè¿˜æ˜¯çœ‹åˆ«äººçš„å§ï¼[ç‚¹æˆ‘](https://www.cnblogs.com/reverymoon/p/10197711.html)

æ€»ç»“ä¸€ä¸‹ï¼Œå°†å¯¹åºåˆ— $a$ åš fwt è§†ä½œæŠŠ $a$ ä½œä¸ºå‘é‡ä¹˜ä¸Šä¸€ä¸ªçŸ©é˜µ $w$ã€‚

è¿™ä¸ªçŸ©é˜µ $w$ éœ€è¦æ»¡è¶³ï¼š

1. $w[x, i] * w[x, j] = w[x, i \oplus j]$
2. $i = (i_0i_1 \cdots i_m)_k$, $w[x, i] = \prod\limits_{t = 0}^m w[x_t, i_t]$

è®¾ $x'$ è¡¨ç¤º $x$ æœ€é«˜ä½ï¼Œ$x''$ è¡¨ç¤ºå…¶ä½™éƒ¨åˆ†ã€‚

$fwt(A)[x] = \sum\limits_{t = 0}^n w[x, t] a_t = \sum\limits_{i = 0}^{k - 1} w[x', i] \sum\limits_{j' = i} w[x'', j''] a_{j}$ã€‚

æ»¡è¶³è¿™ä¿©æ¡ä»¶çš„å°±æ˜¯ $w[x, i] = w_k^{xi}$ã€‚å› æ­¤è¿™ä¸ªçŸ©é˜µé•¿è¿™æ ·ï¼š

$$
\begin{bmatrix}
1 & 1 & \cdots & 1 \\
1 & w_k^1 & \cdots & w_k^{(k - 1)} \\
1 & w_k^2 & \cdots & w_k^{2(k - 1)} \\
\cdots & \cdots & \cdots & \cdots \\
1 & w_k^{k - 1} & \cdots & w_k^{(k - 1)(k - 1)}
\end{bmatrix}
$$

å°±æ˜¯èŒƒå¾·è’™å¾·çŸ©é˜µã€‚è¯¶ï¼ŒèŒƒå¾·è’™å¾·çŸ©é˜µä¸ºå•¥æœ‰é€†ï¼Ÿå› ä¸ºå®ƒçš„è¡Œåˆ—å¼é $0$ï¼Œå®é™…ä¸Šå®ƒè¡Œåˆ—å¼ä¸º $\prod\limits_{i < j} (x_i - x_j)$ ([æ•°å­¦å½’çº³æ³•è¯æ˜](https://blog.csdn.net/keneyr/article/details/102836572))ã€‚

åŒ FFT ä¸­ä¸€æ ·ï¼Œå®ƒçš„é€†ä¸ºï¼š

$$
\frac{1}{k}
\begin{bmatrix}
1 & 1 & \cdots & 1 \\
1 & w_k^{-1} & \cdots & w_k^{-(k - 1)} \\
1 & w_k^{-2} & \cdots & w_k^{-2(k - 1)} \\
\cdots & \cdots & \cdots & \cdots \\
1 & w_k^{-(k - 1)} & \cdots & w_k^{-(k - 1)(k - 1)}
\end{bmatrix}
$$

<details>
    <summary>Gym102978G</summary>
    ``` c++
    const int N = 105, mod = 998244353;
    int n, a[N], len;
    ll K;
    poly f;

    int tmp[10], w[65], wn;
    void init() {
      wn = qpow(3, (mod - 1) / 7);  // æ¨¡æ„ä¹‰ä¸‹ k æ¬¡å•ä½æ ¹ç”±æŸä¸ªåŸæ ¹æ±‚å¾—
      w[0] = 1;
      rep(i, 1, 60) w[i] = mul(w[i - 1], wn);
    }
    void kfwt(poly &a, int n) {  // 7 è¿›åˆ¶ fwt
      for (int i = 1; i < n; i *= 7) {
        for (int j = 0; j < n; j += i * 7) {
          for (int k = j; k < j + i; k++) {
            clr(tmp);
            rep(x, 0, 6) {  // æšä¸¾å½“å‰å±‚æœ€é«˜ä½ï¼Œå³ğŸ‘†é‚£ä¸ªè½¬ç§»å¼é‡Œçš„ x'
              rep(y, 0, 6) {  // æ˜¯ğŸ‘†é‚£ä¸ªè½¬ç§»å¼é‡Œçš„ i
                Add(tmp[x], mul(w[x * y], a[y * i + k]));  // y * i + kï¼šæœ€é«˜ä½ä¸º y çš„ä¸‹æ ‡
              }
            }
            rep(x, 0, 6)
              a[x * i + k] = tmp[x];
          }
        }
      }
    }  // ä¸æ‡‚å°±ç”»æ ‘çŠ¶å›¾ï¼

    signed main() {
      rd(n), rd(K);
      len = qpow(7, 7);
      f.resize(len);
      rep(i, 1, n) {
        int x; rd(x);
        int cur = 0;
        rep(j, 0, 6) cur = cur * 7 + (x & 1), x >>= 1;
        f[cur]++;
      }
      init();
      kfwt(f, len);
      rep(i, 0, len - 1) f[i] = qpow(f[i], K);
      kfwt(f, len);
      printf("%d\n", mul(f[0], qpow(len)));
      return 0;
    }
    ```
</details>

### [çŸ³å®¶åº„çš„å·¥äººé˜¶çº§é˜Ÿä¼æ¯”è¾ƒåšå¼º](https://uoj.ac/problem/272)

å½“ç„¶è¦åŒ–å¥‡æ€ªè§„åˆ™ä¸ºä¸€èˆ¬ã€‚å‘ç°èµ¢çš„ç›¸å‡ä¸º $1$ï¼Œå–æ¨¡æ„ä¹‰ä¸‹è¾“çš„ç›¸å‡ä¸º $2$ï¼Œå¹³å±€å½“ç„¶æ˜¯ $0$ äº†ã€‚è®° $B_{x - y} = b_{u, v} = b_{cnt(x - y, 1), cnt(x - y, 2)}$ã€‚åˆ™ $f_{i, z} = \sum\limits_{x + y = z} f_{i - 1, x} B_{y}$ï¼Œè¿™é‡Œçš„åŠ å‡æ³•æ˜¯ä¸‰è¿›åˆ¶ä¸è¿›ä½åŠ å‡æ³•ã€‚

æ‰€ä»¥è¿™å°±æ˜¯ä¸ª $n$ ç»´ï¼Œæ¯ç»´é•¿åº¦ $3$ çš„ DFT / $3$ è¿›åˆ¶ FWT åšç‚¹å€¼å¿«é€Ÿå¹‚ã€‚ç”¨ä¸Šé¢æ„é€ çŸ©é˜µçš„æ–¹æ³•æ„é€ ä¸€ä¸ª $3 * 3$ å•ä½æ ¹çŸ©é˜µã€‚$3$ çš„å•ä½æ ¹æ˜¯ $\omega = \frac{-1+\sqrt{3}i}{2}$ï¼Œæˆ‘ä»¬é€‰æ‹©æ‰©åŸŸï¼Œä½†æ˜¯ $\sqrt{3}$ ç²¾åº¦ä¼šæœ‰é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå¤æ•°è¡¨ç¤ºæˆ $a + b\omega$ çš„å½¢å¼è€Œä¸æ˜¯ $a + bi$ï¼ŒIDFT ä¹‹å $\omega$ å°±æ²¡äº†ã€‚

æ ¹æ® $\omega_3$ çš„æ€§è´¨ï¼š$\omega^2 + \omega + 1 = 0$ï¼ˆå¯ä»å‡ ä½•æ„ä¹‰ç†è§£ï¼‰ï¼Œå¯ä»¥æ¨å¾—ä¹˜æ³•ï¼š$(a + b\omega)(c + d\omega) = (ac - bd) + (ad + bc - bd)\omega$

IDFT è¦é™¤ä»¥ $n = 3^m$ï¼Œéœ€è¦ $n$ å­˜åœ¨é€†å…ƒï¼Œå³æ¨¡æ•° $p$ ä¸æ˜¯ $3$ çš„å€æ•°ã€‚é¢˜ç›®é‚£ä¸ªæ€§è´¨ä¿è¯äº†è¿™ç‚¹ï¼šç”¨åè¯æ³•ï¼Œè®¾å­˜åœ¨æ­£æ•´æ•° $k = p / 3$ï¼Œé‚£ä¹ˆæœ‰ $1 / k + 1 / k(k + 1) = 1 / k = 3 / p$ï¼ŒçŸ›ç›¾ã€‚

[$Code$](https://uoj.ac/submission/453533)

ç±»ä¼¼çš„ä¹ é¢˜è¿˜æœ‰ $CF1103E$ï¼Œå†™åœ¨ã€Œ21Feb è®­ç»ƒæ—¥å¿—ã€ã€‚

## é›†åˆå¹‚çº§æ•°æ±‚é€†

æˆ‘ä»¬æ±‚è§£å­é›†å·ç§¯æ—¶æ˜¯å°†å¯¹åº”é›†åˆå ä½å¹‚çº§æ•°å¯¹åº”é¡¹çš„å½¢å¼å¹‚çº§æ•°ç›¸ä¹˜ï¼Œå› æ­¤é€†å˜æ¢æ—¶åªéœ€å°†å¯¹åº”é¡¹å½¢å¼å¹‚çº§æ•°ç›¸é™¤å³å¯ã€‚

å®šä¹‰é›†åˆå¹‚çº§æ•° $g$ çš„é€†å…ƒæ˜¯ $g^{-1}$ï¼Œå½“ä¸”ä»…å½“ $g * g^{-1} = å•ä½å…ƒ x^{\emptyset}$ã€‚å¦‚ä½•æ±‚é€†å…ƒï¼Ÿ

**ç…§ç€å­é›†å·ç§¯çš„æ­¥éª¤ä¸€æ­¥æ­¥å€’æ¨ã€‚** 

æŠŠ $g$ FMT ä¸ºé›†åˆå ä½å¹‚çº§æ•° $\Rightarrow$ å¯¹å ä½å¹‚çº§æ•°æ¯ä¸€ä½ä¸Šçš„**å½¢å¼å¹‚çº§æ•°**æ±‚é€† $\Rightarrow$ IFMTï¼ˆä¸æ‡‚ç¬¬äºŒæ­¥ä»€ä¹ˆæ„æ€å°±å»çœ‹ã€Œå·åŒºåˆ’åˆ†ã€ä»£ç ï¼‰

ç”±äº FWT å¤æ‚åº¦ $O(n^22^n)$ï¼Œå¤æ‚åº¦ç“¶é¢ˆå¹¶ä¸åœ¨æ±‚é€†ï¼Œè¿™é‡Œä½¿ç”¨ $O(n^2)$ çš„æ±‚é€†æ–¹æ³•è¶³å¤Ÿã€‚

$$\sum\limits_{i = 0}^{n} a_i b_{n - i} = [n = 0]$$

$n = 0$ æ—¶ $a_n = \frac{1}{b_0}$ï¼›$n > 0$ æ—¶ä¸ºæ»¡è¶³ä¸Šé¢è¿™ä¸ªï¼Œæœ‰ $a_n b_0 = 0 - \sum\limits_{i = 0}^{n - 1} a_i b_{n - i}$ï¼Œå³ $a_n = - \frac{1}{b_0} \sum\limits_{i = 0}^{n - 1} a_i b_{n - i}$

## é›†åˆå¹‚çº§æ•° $\ln$ & $\exp$

é›†åˆå¹‚çº§æ•°ä¹Ÿæœ‰ç±»ä¼¼äºæ£®æ—çš„ EGFã€‚

è®¾é›†åˆå¹‚çº§æ•° $F(x)$ è¡¨ç¤ºè¿é€šå­å›¾çš„ä¸ªæ•°ï¼Œ$G(x)$ è¡¨ç¤ºå­å›¾çš„ä¸ªæ•°ï¼Œæœ‰ $G = \sum\limits_{i \geq 1} \frac{F^i}{i!} = e^F - 1$ï¼ˆè¿™é‡Œçš„ä¹˜æ³•å®šä¹‰ä¸º**å­é›†å·ç§¯**ï¼‰ï¼Œé‚£ä¹ˆæœ‰ $F = \ln(G + 1) = \sum\limits_{i \geq 1} \frac{(-1)^{i + 1} G^i}{i}$ã€‚$G$ å¥½æ±‚ï¼Œæ±‚å‡ºæ¯ä¸ªç‚¹é›† $S$ çš„å¯¼å‡ºå­å›¾è¾¹æ•° $m_S$ï¼Œé‚£ä¹ˆå°±æœ‰ $G_S = 2^{m_S}$ã€‚

è¿™é‡Œçš„ä¹˜æ³•æ˜¯å­é›†å·ç§¯ã€‚è®¾ $f_{|S|, S} = \frac{F_S}{|S|!}$ã€‚ä¸€åˆ—â€”â€”å³ä¸€ä¸ªå ä½å¹‚çº§æ•°â€”â€”æ˜¯ä¸ª EGFã€‚

å…·ä½“å®ç°ï¼Œä»¥ $\exp$ ä¸ºä¾‹ï¼Œæµç¨‹ä¸ºï¼šè¡ŒFMTï¼ˆor å·ç§¯ï¼‰$\Longrightarrow$ åˆ— $\exp$ï¼ˆå­é›†å·ç§¯ä¸­ FMT åæ¯ä½å¯¹åº”ç›¸ä¹˜ï¼Œé‚£ä¹ˆ $\exp$ ä¸­å°±æ˜¯æ¯ä½ç‹¬ç«‹åšå½¢å¼å¹‚çº§æ•° $\exp$ï¼‰ $\Longrightarrow$ è¡ŒIFMTã€‚$\ln$ ç±»ä¼¼ã€‚

å½¢å¼å¹‚çº§æ•° $n^2$ æ±‚ $\ln$ çš„æ–¹æ³•ï¼šè®¾ $a = \sum\limits_{k \geq 1} a_k z^k$ï¼Œæ±‚ $b = \ln(1 + a)$ï¼Œæœ‰ï¼š

$$b' = \frac{a'}{1 + a}$$

$$b'(1 + a) = a'$$

$$b'_k + \sum\limits_{i = 0}^{k - 1} b'_i a_{k - i} = a'_k$$

$$b_{k + 1} = a_{k + 1} - \frac{1}{k + 1} \sum\limits_{i = 0}^{k - 1} (i + 1)b_{i + 1} a_{k - i}$$

å³

$$b_i = a_i - \frac{1}{i} \sum\limits_{j = 1}^{i - 1} j * b_j * a_{i - j}$$

æ³¨æ„ $b_0 = 0$ã€‚

æ±‚ $\exp$ åˆ™æ˜¯ç±»ä¼¼çš„ã€‚è®¾ $b = e^a$ï¼Œæœ€åæ¨å¾—ï¼š

$$b_{k + 1} = a_{k + 1} + \frac{1}{k + 1} \sum\limits_{i = 0}^k (i + 1) a_{i + 1} b_{k - i}$$

å³

$$b_i = a_i + \frac{1}{i} \sum\limits_{j = 1}^{i - 1} j * a_j * b_{i - j}$$

æ³¨æ„ $b_0 = 1$ã€‚

$\ln$ å’Œ $\exp$ å¯ä»¥ç”¨æ¥å¾ˆå¥½çš„è§£å†³ç”Ÿæˆå­å›¾è®¡æ•°é—®é¢˜ã€‚$\ln$ å¯ç†è§£ä¸º $\exp$ çš„é€†è¿ç®—ã€‚$\exp$ çš„ç»„åˆæ„ä¹‰æ˜¯é€‰å–è‹¥å¹²ä¸ç›¸äº¤é›†åˆæ‹¼æˆ $S$ çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆåè¿‡æ¥ $\ln$ çš„ç»„åˆæ„ä¹‰å°±æ˜¯æŠŠ $S$ åˆ’åˆ†æˆè‹¥å¹²ä¸ç›¸äº¤é›†åˆçš„æ–¹æ¡ˆæ•°ã€‚

### [æ¬§æ‹‰ç”Ÿæˆå­å›¾è®¡æ•°](https://loj.ac/p/6673)

ç”Ÿæˆå­å›¾å³åŸå›¾ä¸­åˆ å»è‹¥å¹²æ¡è¾¹ï¼ˆå¯ä»¥æ˜¯ $0$ æ¡ï¼‰åå½¢æˆçš„å›¾ã€‚

æ€è·¯æ˜¯å…ˆç®—æ¯ä¸ªç‚¹åº¦æ•°éƒ½æ˜¯å¶æ•°çš„å­å›¾æ•°ï¼ˆåˆ—å‡ºå…³äºæ¯ä¸ªç‚¹åº¦æ•°çš„å¼‚æˆ–æ–¹ç¨‹ç»„ï¼Œå…¶è§£æ•°ï¼Œå³è‡ªç”±å…ƒæ•°ï¼Œå³ä¸ºå¶å­å›¾æ•°ï¼‰ï¼Œå†ç”¨ $\ln$ æ±‚è¿é€šå­å›¾æ•°ã€‚

**è‡ªç”±å…ƒæ•°ä¸ºä»€ä¹ˆæ˜¯æ¯ä¸ªè¿é€šå—çš„éæ ‘è¾¹æ•°å‘¢ï¼Ÿ** å‘ç°ç­‰ä»·äºé“¾å¼‚æˆ–ï¼Œæ‰€ä»¥ä¸ç®¡éæ ‘è¾¹æ€ä¹ˆé€‰ï¼Œéƒ½èƒ½é€šè¿‡è°ƒæ•´æ ‘è¾¹çš„é€‰å–æ¥æ»¡è¶³æ˜¯ä¸ªå¶å­å›¾ï¼ˆä¸ä¸€å®šè¿é€šï¼‰ã€‚

[$Code$](https://loj.ac/s/1068571)

### [ç‚¹åŒè¿é€šç”Ÿæˆå­å›¾è®¡æ•°](https://loj.ac/p/6729)

å®¹æ–¥ã€‚è€ƒè™‘å…ˆæ±‚è¿é€šå­å›¾æ•°ï¼Œå†ä»å°åˆ°å¤§æšä¸¾ $i$ï¼Œä¾æ¬¡å»æ‰ $i$ ä¸ºå‰²ç‚¹çš„æ–¹æ¡ˆã€‚

å¯ä»¥æŠŠåŒ…å« $i$ çš„é¡¹æå‡ºï¼Œå¾—åˆ°å‰²ç‚¹ $\geq i$ çš„è¿é€šå­å›¾æ•°ï¼Œå¯¹æ­¤æ±‚ $\ln$ å¾—åˆ°å‰²ç‚¹ $> i$ çš„è¿é€šå­å›¾æ•°ã€‚

ä½†æ˜¯æ¯æ¬¡ FMT å¸¸æ•°çˆ†ç‚¸ï¼Œè€ƒè™‘ FMT å®ƒåªæ˜¯æ±‚äº†ä¸ªé«˜ç»´å‰ç¼€å’Œï¼Œä¸å¦‚ä¿ç•™ FMTï¼Œæ¯æ¬¡å·®åˆ†å¾—åˆ°ã€Œå‰²ç‚¹ $\geq i$ çš„è¿é€šå­å›¾æ•°ã€ï¼Œå¤æ‚åº¦ $O(2^n n^3)$

å…·ä½“å®ç°ï¼š$g_{s, k - 1} = f_{s, k} - f_{s - 2^i, k}$ï¼Œæ³¨æ„æ˜¯å ä½ç¬¦æ˜¯ $k - 1$ å› ä¸ºåˆ äº†ä¸ª $i$ï¼Œç„¶åå¯¹ $g$ æ±‚ $\ln$ å› ä¸ºæ­¤æ—¶çš„ $g$ **ä»…è¡¨ç¤ºå­å›¾æ•°**ï¼Œå† $f_{s, k} = f_{s - 2^i, k} + (æ±‚è¿‡ \ln åçš„ g_{s, k - 1})$ã€‚

[$Code$](https://loj.ac/s/1068685)

### [è¾¹åŒè¿é€šç”Ÿæˆå­å›¾è®¡æ•°](https://loj.ac/p/6730)

æ¯ä¸€æ¡è¾¹éƒ½å¿…é¡»åœ¨è‡³å°‘ä¸€ä¸ªç¯ä¸­â€”â€”è¿™æ„å‘³ç€æ¯ä¸ªè¾¹åŒéƒ½è¢«åŒ…å«åœ¨ä¸€ä¸ªæ›´å¤§çš„ç‚¹åŒä¸­ã€‚**è¾¹åŒè¿é€šå›¾å°±æ˜¯æ²¡æœ‰ä¸º $2$ çš„ç‚¹åŒè¿é€šåˆ†é‡çš„å›¾**ã€‚

å¤§å°ä¸º $2$ çš„ç‚¹åŒè¿é€šåˆ†é‡æ²¡æœ‰åŠæ³•åƒå•ç‹¬ä¸€ä¸ªç‚¹é‚£æ ·ç›´æ¥æ‹†è§£å‡ºæ¥ã€‚è€ƒè™‘å…ˆæŠŠå¤§å° $\leq 2$ çš„å—ç½®ä¸º $0$ï¼Œ$> 2$ çš„å—åˆ™åƒç‚¹åŒé‚£æ ·ç”±ã€Œå¼ºåˆ¶å»æ‰ä¸€ä¸ªç‚¹ã€åå½¢æˆçš„å—æ‹¼èµ·æ¥ï¼Œä¹Ÿå°±æ˜¯åš $\exp$ã€‚å¤æ‚åº¦ä»ä¸º $O(2^n n^3)$ã€‚

[$Code$](https://loj.ac/s/1069238)

### [èƒ¡ç­–çš„ç»Ÿè®¡](https://uoj.ac/problem/94)

è®¾ $g_S$ è¡¨ç¤º $S$ çš„è¿é€šå­å›¾æ•°ï¼Œ$f_S$ ä¸ºé›†åˆ $S$ çš„ç­”æ¡ˆã€‚åˆ—å‡ºæŸ¿å­å°±ä¼šå‘ç°å¥½æ±‚çš„å¾ˆï¼š$F = 1 + \sum\limits_{k \geq 1} \frac{G^k}{k!} k! = \frac{1}{1 - G}$ï¼ˆé›†åˆå¹‚çº§æ•°çš„ä¹˜æ³•å°±æ˜¯å­é›†å·ç§¯ï¼Œå®ƒæ˜¯ä¸äº¤å¹¶ï¼‰ï¼Œæ‰€ä»¥ $\ln$ + æ±‚é€† å³å¯ã€‚

[$Code$](https://uoj.ac/submission/456692)

### [300iq-æ•°ä»™äººæŒ](https://loj.ac/p/6719)

å°†ä¸€æ¡è¾¹ä¹Ÿçœ‹ä½œç¯ï¼Œä»™äººæŒå°±æ˜¯è®¸å¤šç¯æ‹¼åœ¨ä¸€èµ·ã€‚

å‡­å€Ÿ xza æ¨¡æ‹Ÿèµ›æ•™è‚²è¿‡ä½ çš„ exp çŸ¥è¯†ï¼Œåº”è¯¥å¯ä»¥è½»æ¾ AC æ­¤é¢˜ï¼ˆåˆ’æ‰ï¼‰ã€‚

ä»å°åˆ°å¤§æšä¸¾æ¯ä¸ªç‚¹ï¼ŒæŠŠåŒ…å«å®ƒçš„ç¯æ‹¼èµ·æ¥ã€‚

[$Code$](https://loj.ac/s/1127846)

ä¸‹é¢æ˜¯é¸½ç€çš„ï¼ˆé¢˜å•ä» xyx é‚£é‡Œè´ºçš„ï¼‰ï¼š

[tutteå¤šé¡¹å¼](https://loj.ac/p/155)

## é›†åˆå¹‚çº§æ•°æ±‚å¯¼

### [é›†åˆåˆ’åˆ†è®¡æ•°](https://loj.ac/p/154)

æ˜¾ç„¶æ±‚çš„æ˜¯ $g = \exp_{\leq k} f = \sum\limits_{i = 0}^k \frac{f^i}{i!}$

æ±‚å¯¼ï¼š

$$g' = \sum\limits_{i = 1}^k \frac{i f^{i - 1} f'}{i!} = f' \sum\limits_{i = 0}^{k - 1} \frac{f^i}{i!} = f'(g - \frac{f^k}{k!})$$

*ç„¶è€Œä¸ä¼šæ±‚å¯¼çš„æ¿å­ï¼Œå’•å’•*