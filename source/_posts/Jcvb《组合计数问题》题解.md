---
title: 'Jcvb《组合计数问题》题解'
date: 2020-07-30 18:25:40
tags:
    - 容斥原理
    - 计数
---

* 组合数、stirling数
* 生成函数 + FFT/NTT
* 一些特定的结论（矩阵树，burnside，prufer...）
* 一些思想（容斥、补集转化）

都是常用的技巧！

DP 每道都是吧 qvq 太重要了，有时用 FFT/NTT 加速。

## [[TC12004]-SetAndSet](https://vjudge.net/problem/Topcoder-12004)
-----

按位考虑。

若对于某一位，存在一个数当前位为 0，则这一位为 0 的数不能全在一边。

不能全在一边 就很难做，考虑**补集转化**，计算 全在一边 的。我们发现这样会算重，准确来说算的是“至少有几位不同”。

考虑**容斥思想**，答案 = 总数 - 至少 1 位不同 + 至少 2 位不同 - ...

用 dfs 枚举，并查集维护即可，将枚举位为 0 的并到一块儿去。

## [BZOJ1471]-不相交路径
-----

不相交难做，相交好做。考虑**容斥**第一个相交的点。计算总方案数的时候用到了拓扑序（路径上排在 x 前面的点 y，拓扑序一定比 x 小）

## [SHOI2009]-舞会
-----

就是那道-已经没有什么好害怕的了，dp 计算 g 数组，f[i, j] 表示前 i 个女生有 j 个匹配了。

## [某CEOI题]
-----

什么容斥小于号改为大于号的，咕咕

## [TC14170]-Divfree
-----

想不到的容斥dp。。

不合法的状态 (A, B) 是 B 是 A 的真约数时。数字 k 的真约数只有 log(k) 个，k 是 50000，也就是说不合法的链的长度最多 16。

考虑容斥，f[i] 表示**合法的**长度为 i 的链方案数，g[i] 表示**不合法的**长度为 i 的链方案数。g 可以预处理。

$f[n] = f[n - 1] * g[1] - f[n - 2] * g[2] + f[n - 3] * g[3]...$ 太妙了。

## [稳定多米诺覆盖]
-----

[链接](https://imilyx.github.io/2020/07/30/[51nod1518]-%E7%A8%B3%E5%AE%9A%E5%A4%9A%E7%B1%B3%E8%AF%BA%E8%A6%86%E7%9B%96/)

## [TC13891]-Gxor
-----

